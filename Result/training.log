2025-12-10 17:16:13,699 - INFO - ========== Running model: lr ==========
2025-12-10 17:16:13,764 - INFO - Data loaded with shape (5382, 44)
2025-12-10 17:16:13,783 - INFO - Preprocessing created. Will be fitted inside the pipeline. Categorical cols: ['name', 'gender', 'education', 'profession', 'living_with', 'nation', 'phone', 'job', 'marriage_status', 'purpose', 'go_with', 'weather', 'time', 'age_group'], Numerical cols: ['id', 'age', 'income', 'fb_freq', 'yt_freq', 'tik_freq', 'use_less_than_2GB', 'use_2GB_to_4GB', 'number_child', 'viettel_no_0', 'viettel_no_1', 'viettel_no_2', 'to_hanoi', 'to_other', 'score', 'number_of_suggestions', 'number_of_plans', 'number_of_accept', 'number_of_accept_2', 'freq', 'accept_rate', 'Smaller_than_6M', '6M_to_12M', '12M_to_20M', 'Higher_than_20M', 'time_morning', 'time_afternoon', 'time_evening', 'time_night'], Scaler applied: True
2025-12-10 17:16:13,786 - INFO - [FS] Method: SelectKBest | k=40 | score_func=f_classif
2025-12-10 17:16:13,788 - INFO - [FS] Selector created. Will be fitted inside the pipeline.
2025-12-10 17:16:13,814 - INFO - Train shape: (4305, 43), Val shape: (1077, 43)
2025-12-10 17:16:13,846 - INFO - Downsample completed. Before: {3: 1158, 2: 1137, 4: 1018, 0: 542, 1: 450} | After: {0: 450, 1: 450, 2: 450, 3: 450, 4: 450}
2025-12-10 17:16:13,849 - INFO - Pipeline built successfully. Steps: ['preprocessor', 'selector', 'classifier']
2025-12-10 17:16:13,853 - INFO - Training started on 2250 samples using model=LR.
2025-12-10 17:16:14,107 - INFO - Training completed in 0.25 seconds.
2025-12-10 17:16:14,109 - INFO - Hyperparameter search started. Method=GRID, Scoring=f1_macro
2025-12-10 17:16:17,644 - INFO - Hyperparameter optimization completed. Best params: {'classifier__C': 0.1, 'classifier__max_iter': 500, 'classifier__solver': 'lbfgs'}
2025-12-10 17:16:17,655 - INFO - Retrain lr after optimization...
2025-12-10 17:16:17,663 - INFO - Pipeline built successfully. Steps: ['preprocessor', 'selector', 'classifier']
2025-12-10 17:16:17,671 - INFO - Training started on 2250 samples using model=LR.
2025-12-10 17:16:18,126 - INFO - Training completed in 0.45 seconds.
2025-12-10 17:16:18,138 - INFO - Preprocessing created. Will be fitted inside the pipeline. Categorical cols: ['name', 'gender', 'education', 'profession', 'living_with', 'nation', 'phone', 'job', 'marriage_status', 'purpose', 'go_with', 'weather', 'time', 'age_group'], Numerical cols: ['id', 'age', 'income', 'fb_freq', 'yt_freq', 'tik_freq', 'use_less_than_2GB', 'use_2GB_to_4GB', 'number_child', 'viettel_no_0', 'viettel_no_1', 'viettel_no_2', 'to_hanoi', 'to_other', 'score', 'number_of_suggestions', 'number_of_plans', 'number_of_accept', 'number_of_accept_2', 'freq', 'accept_rate', 'Smaller_than_6M', '6M_to_12M', '12M_to_20M', 'Higher_than_20M', 'time_morning', 'time_afternoon', 'time_evening', 'time_night'], Scaler applied: True
2025-12-10 17:16:18,147 - INFO - Evaluation started...
2025-12-10 17:16:18,250 - INFO - Evaluation results - Accuracy=0.4015, F1-macro=0.3814, Precision=0.3773, Recall=0.3960
2025-12-10 17:16:19,001 - INFO - ========== Running model: svm ==========
2025-12-10 17:16:19,060 - INFO - Data loaded with shape (5382, 44)
2025-12-10 17:16:19,070 - INFO - Preprocessing created. Will be fitted inside the pipeline. Categorical cols: ['name', 'gender', 'education', 'profession', 'living_with', 'nation', 'phone', 'job', 'marriage_status', 'purpose', 'go_with', 'weather', 'time', 'age_group'], Numerical cols: ['id', 'age', 'income', 'fb_freq', 'yt_freq', 'tik_freq', 'use_less_than_2GB', 'use_2GB_to_4GB', 'number_child', 'viettel_no_0', 'viettel_no_1', 'viettel_no_2', 'to_hanoi', 'to_other', 'score', 'number_of_suggestions', 'number_of_plans', 'number_of_accept', 'number_of_accept_2', 'freq', 'accept_rate', 'Smaller_than_6M', '6M_to_12M', '12M_to_20M', 'Higher_than_20M', 'time_morning', 'time_afternoon', 'time_evening', 'time_night'], Scaler applied: True
2025-12-10 17:16:19,073 - INFO - [FS] Method: SelectKBest | k=40 | score_func=f_classif
2025-12-10 17:16:19,076 - INFO - [FS] Selector created. Will be fitted inside the pipeline.
2025-12-10 17:16:19,097 - INFO - Train shape: (4305, 43), Val shape: (1077, 43)
2025-12-10 17:16:19,126 - INFO - Downsample completed. Before: {3: 1158, 2: 1137, 4: 1018, 0: 542, 1: 450} | After: {0: 450, 1: 450, 2: 450, 3: 450, 4: 450}
2025-12-10 17:16:19,129 - INFO - Pipeline built successfully. Steps: ['preprocessor', 'selector', 'classifier']
2025-12-10 17:16:19,130 - INFO - Training started on 2250 samples using model=SVM.
2025-12-10 17:16:22,041 - INFO - Training completed in 2.91 seconds.
2025-12-10 17:16:22,043 - INFO - Hyperparameter search started. Method=GRID, Scoring=f1_macro
2025-12-10 17:16:51,591 - INFO - Hyperparameter optimization completed. Best params: {'classifier__C': 10.0, 'classifier__gamma': 'scale', 'classifier__kernel': 'rbf'}
2025-12-10 17:16:51,593 - INFO - Retrain svm after optimization...
2025-12-10 17:16:51,597 - INFO - Pipeline built successfully. Steps: ['preprocessor', 'selector', 'classifier']
2025-12-10 17:16:51,599 - INFO - Training started on 2250 samples using model=SVM.
2025-12-10 17:16:54,094 - INFO - Training completed in 2.49 seconds.
2025-12-10 17:16:54,101 - INFO - Preprocessing created. Will be fitted inside the pipeline. Categorical cols: ['name', 'gender', 'education', 'profession', 'living_with', 'nation', 'phone', 'job', 'marriage_status', 'purpose', 'go_with', 'weather', 'time', 'age_group'], Numerical cols: ['id', 'age', 'income', 'fb_freq', 'yt_freq', 'tik_freq', 'use_less_than_2GB', 'use_2GB_to_4GB', 'number_child', 'viettel_no_0', 'viettel_no_1', 'viettel_no_2', 'to_hanoi', 'to_other', 'score', 'number_of_suggestions', 'number_of_plans', 'number_of_accept', 'number_of_accept_2', 'freq', 'accept_rate', 'Smaller_than_6M', '6M_to_12M', '12M_to_20M', 'Higher_than_20M', 'time_morning', 'time_afternoon', 'time_evening', 'time_night'], Scaler applied: True
2025-12-10 17:16:54,105 - INFO - Evaluation started...
2025-12-10 17:16:54,222 - INFO - Evaluation results - Accuracy=0.4389, F1-macro=0.4372, Precision=0.4484, Recall=0.4832
2025-12-10 17:16:54,755 - INFO - ========== Running model: rf ==========
2025-12-10 17:16:54,800 - INFO - Data loaded with shape (5382, 44)
2025-12-10 17:16:54,813 - INFO - Preprocessing created. Will be fitted inside the pipeline. Categorical cols: ['name', 'gender', 'education', 'profession', 'living_with', 'nation', 'phone', 'job', 'marriage_status', 'purpose', 'go_with', 'weather', 'time', 'age_group'], Numerical cols: ['id', 'age', 'income', 'fb_freq', 'yt_freq', 'tik_freq', 'use_less_than_2GB', 'use_2GB_to_4GB', 'number_child', 'viettel_no_0', 'viettel_no_1', 'viettel_no_2', 'to_hanoi', 'to_other', 'score', 'number_of_suggestions', 'number_of_plans', 'number_of_accept', 'number_of_accept_2', 'freq', 'accept_rate', 'Smaller_than_6M', '6M_to_12M', '12M_to_20M', 'Higher_than_20M', 'time_morning', 'time_afternoon', 'time_evening', 'time_night'], Scaler applied: False
2025-12-10 17:16:54,815 - INFO - [FS] Method: SelectKBest | k=40 | score_func=f_classif
2025-12-10 17:16:54,817 - INFO - [FS] Selector created. Will be fitted inside the pipeline.
2025-12-10 17:16:54,837 - INFO - Train shape: (4305, 43), Val shape: (1077, 43)
2025-12-10 17:16:54,862 - INFO - Downsample completed. Before: {3: 1158, 2: 1137, 4: 1018, 0: 542, 1: 450} | After: {0: 450, 1: 450, 2: 450, 3: 450, 4: 450}
2025-12-10 17:16:54,866 - INFO - Pipeline built successfully. Steps: ['preprocessor', 'selector', 'classifier']
2025-12-10 17:16:54,867 - INFO - Training started on 2250 samples using model=RF.
2025-12-10 17:16:56,317 - INFO - Training completed in 1.45 seconds.
2025-12-10 17:16:56,322 - INFO - Hyperparameter search started. Method=GRID, Scoring=f1_macro
2025-12-10 17:19:17,334 - INFO - Hyperparameter optimization completed. Best params: {'classifier__max_depth': 20, 'classifier__min_samples_leaf': 1, 'classifier__min_samples_split': 10, 'classifier__n_estimators': 200}
2025-12-10 17:19:17,336 - INFO - Retrain rf after optimization...
2025-12-10 17:19:17,340 - INFO - Pipeline built successfully. Steps: ['preprocessor', 'selector', 'classifier']
2025-12-10 17:19:17,342 - INFO - Training started on 2250 samples using model=RF.
2025-12-10 17:19:18,687 - INFO - Training completed in 1.34 seconds.
2025-12-10 17:19:18,696 - INFO - Preprocessing created. Will be fitted inside the pipeline. Categorical cols: ['name', 'gender', 'education', 'profession', 'living_with', 'nation', 'phone', 'job', 'marriage_status', 'purpose', 'go_with', 'weather', 'time', 'age_group'], Numerical cols: ['id', 'age', 'income', 'fb_freq', 'yt_freq', 'tik_freq', 'use_less_than_2GB', 'use_2GB_to_4GB', 'number_child', 'viettel_no_0', 'viettel_no_1', 'viettel_no_2', 'to_hanoi', 'to_other', 'score', 'number_of_suggestions', 'number_of_plans', 'number_of_accept', 'number_of_accept_2', 'freq', 'accept_rate', 'Smaller_than_6M', '6M_to_12M', '12M_to_20M', 'Higher_than_20M', 'time_morning', 'time_afternoon', 'time_evening', 'time_night'], Scaler applied: False
2025-12-10 17:19:18,701 - INFO - Evaluation started...
2025-12-10 17:19:18,765 - INFO - Evaluation results - Accuracy=0.5810, F1-macro=0.5526, Precision=0.5440, Recall=0.5769
2025-12-10 17:19:19,264 - INFO - ========== Running model: lgbm ==========
2025-12-10 17:19:19,311 - INFO - Data loaded with shape (5382, 44)
2025-12-10 17:19:19,322 - INFO - Preprocessing created. Will be fitted inside the pipeline. Categorical cols: ['name', 'gender', 'education', 'profession', 'living_with', 'nation', 'phone', 'job', 'marriage_status', 'purpose', 'go_with', 'weather', 'time', 'age_group'], Numerical cols: ['id', 'age', 'income', 'fb_freq', 'yt_freq', 'tik_freq', 'use_less_than_2GB', 'use_2GB_to_4GB', 'number_child', 'viettel_no_0', 'viettel_no_1', 'viettel_no_2', 'to_hanoi', 'to_other', 'score', 'number_of_suggestions', 'number_of_plans', 'number_of_accept', 'number_of_accept_2', 'freq', 'accept_rate', 'Smaller_than_6M', '6M_to_12M', '12M_to_20M', 'Higher_than_20M', 'time_morning', 'time_afternoon', 'time_evening', 'time_night'], Scaler applied: False
2025-12-10 17:19:19,323 - INFO - [FS] Method: SelectKBest | k=40 | score_func=f_classif
2025-12-10 17:19:19,325 - INFO - [FS] Selector created. Will be fitted inside the pipeline.
2025-12-10 17:19:19,339 - INFO - Train shape: (4305, 43), Val shape: (1077, 43)
2025-12-10 17:19:19,366 - INFO - Downsample completed. Before: {3: 1158, 2: 1137, 4: 1018, 0: 542, 1: 450} | After: {0: 450, 1: 450, 2: 450, 3: 450, 4: 450}
2025-12-10 17:19:19,372 - INFO - Pipeline built successfully. Steps: ['preprocessor', 'selector', 'classifier']
2025-12-10 17:19:19,374 - INFO - Training started on 2250 samples using model=LGBM.
2025-12-10 17:19:19,867 - INFO - Training completed in 0.49 seconds.
2025-12-10 17:19:19,870 - INFO - Hyperparameter search started. Method=GRID, Scoring=f1_macro
2025-12-10 17:21:00,162 - INFO - Hyperparameter optimization completed. Best params: {'classifier__learning_rate': 0.05, 'classifier__max_depth': -1, 'classifier__n_estimators': 300, 'classifier__num_leaves': 20}
2025-12-10 17:21:00,166 - INFO - Retrain lgbm after optimization...
2025-12-10 17:21:00,172 - INFO - Pipeline built successfully. Steps: ['preprocessor', 'selector', 'classifier']
2025-12-10 17:21:00,173 - INFO - Training started on 2250 samples using model=LGBM.
2025-12-10 17:21:00,818 - INFO - Training completed in 0.64 seconds.
2025-12-10 17:21:00,824 - INFO - Preprocessing created. Will be fitted inside the pipeline. Categorical cols: ['name', 'gender', 'education', 'profession', 'living_with', 'nation', 'phone', 'job', 'marriage_status', 'purpose', 'go_with', 'weather', 'time', 'age_group'], Numerical cols: ['id', 'age', 'income', 'fb_freq', 'yt_freq', 'tik_freq', 'use_less_than_2GB', 'use_2GB_to_4GB', 'number_child', 'viettel_no_0', 'viettel_no_1', 'viettel_no_2', 'to_hanoi', 'to_other', 'score', 'number_of_suggestions', 'number_of_plans', 'number_of_accept', 'number_of_accept_2', 'freq', 'accept_rate', 'Smaller_than_6M', '6M_to_12M', '12M_to_20M', 'Higher_than_20M', 'time_morning', 'time_afternoon', 'time_evening', 'time_night'], Scaler applied: False
2025-12-10 17:21:00,828 - INFO - Evaluation started...
2025-12-10 17:21:00,911 - INFO - Evaluation results - Accuracy=0.5262, F1-macro=0.5045, Precision=0.4968, Recall=0.5281
2025-12-10 17:21:01,823 - INFO - ========== Running model: xgb ==========
2025-12-10 17:21:01,872 - INFO - Data loaded with shape (5382, 44)
2025-12-10 17:21:01,882 - INFO - Preprocessing created. Will be fitted inside the pipeline. Categorical cols: ['name', 'gender', 'education', 'profession', 'living_with', 'nation', 'phone', 'job', 'marriage_status', 'purpose', 'go_with', 'weather', 'time', 'age_group'], Numerical cols: ['id', 'age', 'income', 'fb_freq', 'yt_freq', 'tik_freq', 'use_less_than_2GB', 'use_2GB_to_4GB', 'number_child', 'viettel_no_0', 'viettel_no_1', 'viettel_no_2', 'to_hanoi', 'to_other', 'score', 'number_of_suggestions', 'number_of_plans', 'number_of_accept', 'number_of_accept_2', 'freq', 'accept_rate', 'Smaller_than_6M', '6M_to_12M', '12M_to_20M', 'Higher_than_20M', 'time_morning', 'time_afternoon', 'time_evening', 'time_night'], Scaler applied: False
2025-12-10 17:21:01,885 - INFO - [FS] Method: SelectKBest | k=40 | score_func=f_classif
2025-12-10 17:21:01,886 - INFO - [FS] Selector created. Will be fitted inside the pipeline.
2025-12-10 17:21:01,902 - INFO - Train shape: (4305, 43), Val shape: (1077, 43)
2025-12-10 17:21:01,924 - INFO - Downsample completed. Before: {3: 1158, 2: 1137, 4: 1018, 0: 542, 1: 450} | After: {0: 450, 1: 450, 2: 450, 3: 450, 4: 450}
2025-12-10 17:21:01,928 - INFO - Pipeline built successfully. Steps: ['preprocessor', 'selector', 'classifier']
2025-12-10 17:21:01,929 - INFO - Training started on 2250 samples using model=XGB.
2025-12-10 17:21:03,066 - INFO - Training completed in 1.14 seconds.
2025-12-10 17:21:03,070 - INFO - Hyperparameter search started. Method=GRID, Scoring=f1_macro
2025-12-10 17:23:25,988 - INFO - Hyperparameter optimization completed. Best params: {'classifier__colsample_bytree': 0.7, 'classifier__learning_rate': 0.01, 'classifier__max_depth': 6, 'classifier__n_estimators': 100, 'classifier__subsample': 0.9}
2025-12-10 17:23:25,995 - INFO - Retrain xgb after optimization...
2025-12-10 17:23:26,001 - INFO - Pipeline built successfully. Steps: ['preprocessor', 'selector', 'classifier']
2025-12-10 17:23:26,007 - INFO - Training started on 2250 samples using model=XGB.
2025-12-10 17:23:26,493 - INFO - Training completed in 0.48 seconds.
2025-12-10 17:23:26,501 - INFO - Preprocessing created. Will be fitted inside the pipeline. Categorical cols: ['name', 'gender', 'education', 'profession', 'living_with', 'nation', 'phone', 'job', 'marriage_status', 'purpose', 'go_with', 'weather', 'time', 'age_group'], Numerical cols: ['id', 'age', 'income', 'fb_freq', 'yt_freq', 'tik_freq', 'use_less_than_2GB', 'use_2GB_to_4GB', 'number_child', 'viettel_no_0', 'viettel_no_1', 'viettel_no_2', 'to_hanoi', 'to_other', 'score', 'number_of_suggestions', 'number_of_plans', 'number_of_accept', 'number_of_accept_2', 'freq', 'accept_rate', 'Smaller_than_6M', '6M_to_12M', '12M_to_20M', 'Higher_than_20M', 'time_morning', 'time_afternoon', 'time_evening', 'time_night'], Scaler applied: False
2025-12-10 17:23:26,505 - INFO - Evaluation started...
2025-12-10 17:23:26,567 - INFO - Evaluation results - Accuracy=0.5536, F1-macro=0.5294, Precision=0.5204, Recall=0.5512
2025-12-10 17:23:27,058 - INFO - ========== Running model: cat ==========
2025-12-10 17:23:27,101 - INFO - Data loaded with shape (5382, 44)
2025-12-10 17:23:27,111 - INFO - Preprocessing created. Will be fitted inside the pipeline. Categorical cols: ['name', 'gender', 'education', 'profession', 'living_with', 'nation', 'phone', 'job', 'marriage_status', 'purpose', 'go_with', 'weather', 'time', 'age_group'], Numerical cols: ['id', 'age', 'income', 'fb_freq', 'yt_freq', 'tik_freq', 'use_less_than_2GB', 'use_2GB_to_4GB', 'number_child', 'viettel_no_0', 'viettel_no_1', 'viettel_no_2', 'to_hanoi', 'to_other', 'score', 'number_of_suggestions', 'number_of_plans', 'number_of_accept', 'number_of_accept_2', 'freq', 'accept_rate', 'Smaller_than_6M', '6M_to_12M', '12M_to_20M', 'Higher_than_20M', 'time_morning', 'time_afternoon', 'time_evening', 'time_night'], Scaler applied: False
2025-12-10 17:23:27,115 - INFO - [FS] Method: SelectKBest | k=40 | score_func=f_classif
2025-12-10 17:23:27,117 - INFO - [FS] Selector created. Will be fitted inside the pipeline.
2025-12-10 17:23:27,136 - INFO - Train shape: (4305, 43), Val shape: (1077, 43)
2025-12-10 17:23:27,163 - INFO - Downsample completed. Before: {3: 1158, 2: 1137, 4: 1018, 0: 542, 1: 450} | After: {0: 450, 1: 450, 2: 450, 3: 450, 4: 450}
2025-12-10 17:23:27,166 - INFO - Pipeline built successfully. Steps: ['preprocessor', 'selector', 'classifier']
2025-12-10 17:23:27,171 - INFO - Training started on 2250 samples using model=CAT.
2025-12-10 17:23:35,251 - INFO - Training completed in 8.08 seconds.
2025-12-10 17:23:35,253 - INFO - Hyperparameter search started. Method=GRID, Scoring=f1_macro
2025-12-10 17:28:35,493 - INFO - Hyperparameter optimization completed. Best params: {'classifier__depth': 8, 'classifier__iterations': 100, 'classifier__l2_leaf_reg': 5, 'classifier__learning_rate': 0.01}
2025-12-10 17:28:35,497 - INFO - Retrain cat after optimization...
2025-12-10 17:28:35,500 - INFO - Pipeline built successfully. Steps: ['preprocessor', 'selector', 'classifier']
2025-12-10 17:28:35,503 - INFO - Training started on 2250 samples using model=CAT.
2025-12-10 17:28:43,356 - INFO - Training completed in 7.85 seconds.
2025-12-10 17:28:43,364 - INFO - Preprocessing created. Will be fitted inside the pipeline. Categorical cols: ['name', 'gender', 'education', 'profession', 'living_with', 'nation', 'phone', 'job', 'marriage_status', 'purpose', 'go_with', 'weather', 'time', 'age_group'], Numerical cols: ['id', 'age', 'income', 'fb_freq', 'yt_freq', 'tik_freq', 'use_less_than_2GB', 'use_2GB_to_4GB', 'number_child', 'viettel_no_0', 'viettel_no_1', 'viettel_no_2', 'to_hanoi', 'to_other', 'score', 'number_of_suggestions', 'number_of_plans', 'number_of_accept', 'number_of_accept_2', 'freq', 'accept_rate', 'Smaller_than_6M', '6M_to_12M', '12M_to_20M', 'Higher_than_20M', 'time_morning', 'time_afternoon', 'time_evening', 'time_night'], Scaler applied: False
2025-12-10 17:28:43,367 - INFO - Evaluation started...
2025-12-10 17:28:43,422 - INFO - Evaluation results - Accuracy=0.5411, F1-macro=0.5300, Precision=0.5199, Recall=0.5591
2025-12-10 17:33:49,659 - INFO - ========== Running model: lr ==========
2025-12-10 17:33:49,687 - INFO - Data loaded with shape (5382, 44)
2025-12-10 17:33:49,695 - INFO - Preprocessing created. Will be fitted inside the pipeline. Categorical cols: ['name', 'gender', 'education', 'profession', 'living_with', 'nation', 'phone', 'job', 'marriage_status', 'purpose', 'go_with', 'weather', 'time', 'age_group'], Numerical cols: ['id', 'age', 'income', 'fb_freq', 'yt_freq', 'tik_freq', 'use_less_than_2GB', 'use_2GB_to_4GB', 'number_child', 'viettel_no_0', 'viettel_no_1', 'viettel_no_2', 'to_hanoi', 'to_other', 'score', 'number_of_suggestions', 'number_of_plans', 'number_of_accept', 'number_of_accept_2', 'freq', 'accept_rate', 'Smaller_than_6M', '6M_to_12M', '12M_to_20M', 'Higher_than_20M', 'time_morning', 'time_afternoon', 'time_evening', 'time_night'], Scaler applied: True
2025-12-10 17:33:49,696 - INFO - [FS] Method: SelectKBest | k=40 | score_func=f_classif
2025-12-10 17:33:49,698 - INFO - [FS] Selector created. Will be fitted inside the pipeline.
2025-12-10 17:33:49,711 - INFO - Train shape: (4305, 43), Val shape: (1077, 43)
2025-12-10 17:33:49,730 - INFO - Downsample completed. Before: {3: 1158, 2: 1137, 4: 1018, 0: 542, 1: 450} | After: {0: 450, 1: 450, 2: 450, 3: 450, 4: 450}
2025-12-10 17:33:49,736 - INFO - Pipeline built successfully. Steps: ['preprocessor', 'selector', 'classifier']
2025-12-10 17:33:49,737 - INFO - Training started on 2250 samples using model=LR.
2025-12-10 17:33:49,924 - INFO - Training completed in 0.19 seconds.
2025-12-10 17:33:49,927 - INFO - Hyperparameter search started. Method=RANDOM, Scoring=f1_macro
2025-12-10 17:34:02,365 - INFO - Hyperparameter optimization completed. Best params: {'classifier__solver': 'saga', 'classifier__max_iter': 300, 'classifier__C': 0.1}
2025-12-10 17:34:02,368 - INFO - Retrain lr after optimization...
2025-12-10 17:34:02,372 - INFO - Pipeline built successfully. Steps: ['preprocessor', 'selector', 'classifier']
2025-12-10 17:34:02,375 - INFO - Training started on 2250 samples using model=LR.
2025-12-10 17:34:02,544 - INFO - Training completed in 0.17 seconds.
2025-12-10 17:34:02,550 - INFO - Preprocessing created. Will be fitted inside the pipeline. Categorical cols: ['name', 'gender', 'education', 'profession', 'living_with', 'nation', 'phone', 'job', 'marriage_status', 'purpose', 'go_with', 'weather', 'time', 'age_group'], Numerical cols: ['id', 'age', 'income', 'fb_freq', 'yt_freq', 'tik_freq', 'use_less_than_2GB', 'use_2GB_to_4GB', 'number_child', 'viettel_no_0', 'viettel_no_1', 'viettel_no_2', 'to_hanoi', 'to_other', 'score', 'number_of_suggestions', 'number_of_plans', 'number_of_accept', 'number_of_accept_2', 'freq', 'accept_rate', 'Smaller_than_6M', '6M_to_12M', '12M_to_20M', 'Higher_than_20M', 'time_morning', 'time_afternoon', 'time_evening', 'time_night'], Scaler applied: True
2025-12-10 17:34:02,553 - INFO - Evaluation started...
2025-12-10 17:34:02,612 - INFO - Evaluation results - Accuracy=0.4015, F1-macro=0.3814, Precision=0.3773, Recall=0.3960
2025-12-10 17:34:03,088 - INFO - ========== Running model: svm ==========
2025-12-10 17:34:03,125 - INFO - Data loaded with shape (5382, 44)
2025-12-10 17:34:03,134 - INFO - Preprocessing created. Will be fitted inside the pipeline. Categorical cols: ['name', 'gender', 'education', 'profession', 'living_with', 'nation', 'phone', 'job', 'marriage_status', 'purpose', 'go_with', 'weather', 'time', 'age_group'], Numerical cols: ['id', 'age', 'income', 'fb_freq', 'yt_freq', 'tik_freq', 'use_less_than_2GB', 'use_2GB_to_4GB', 'number_child', 'viettel_no_0', 'viettel_no_1', 'viettel_no_2', 'to_hanoi', 'to_other', 'score', 'number_of_suggestions', 'number_of_plans', 'number_of_accept', 'number_of_accept_2', 'freq', 'accept_rate', 'Smaller_than_6M', '6M_to_12M', '12M_to_20M', 'Higher_than_20M', 'time_morning', 'time_afternoon', 'time_evening', 'time_night'], Scaler applied: True
2025-12-10 17:34:03,136 - INFO - [FS] Method: SelectKBest | k=40 | score_func=f_classif
2025-12-10 17:34:03,137 - INFO - [FS] Selector created. Will be fitted inside the pipeline.
2025-12-10 17:34:03,154 - INFO - Train shape: (4305, 43), Val shape: (1077, 43)
2025-12-10 17:34:03,178 - INFO - Downsample completed. Before: {3: 1158, 2: 1137, 4: 1018, 0: 542, 1: 450} | After: {0: 450, 1: 450, 2: 450, 3: 450, 4: 450}
2025-12-10 17:34:03,180 - INFO - Pipeline built successfully. Steps: ['preprocessor', 'selector', 'classifier']
2025-12-10 17:34:03,184 - INFO - Training started on 2250 samples using model=SVM.
2025-12-10 17:34:05,624 - INFO - Training completed in 2.44 seconds.
2025-12-10 17:34:05,626 - INFO - Hyperparameter search started. Method=RANDOM, Scoring=f1_macro
2025-12-10 17:35:06,807 - INFO - Hyperparameter optimization completed. Best params: {'classifier__kernel': 'rbf', 'classifier__gamma': 'auto', 'classifier__C': 10.0}
2025-12-10 17:35:06,809 - INFO - Retrain svm after optimization...
2025-12-10 17:35:06,812 - INFO - Pipeline built successfully. Steps: ['preprocessor', 'selector', 'classifier']
2025-12-10 17:35:06,815 - INFO - Training started on 2250 samples using model=SVM.
2025-12-10 17:35:09,275 - INFO - Training completed in 2.46 seconds.
2025-12-10 17:35:09,280 - INFO - Preprocessing created. Will be fitted inside the pipeline. Categorical cols: ['name', 'gender', 'education', 'profession', 'living_with', 'nation', 'phone', 'job', 'marriage_status', 'purpose', 'go_with', 'weather', 'time', 'age_group'], Numerical cols: ['id', 'age', 'income', 'fb_freq', 'yt_freq', 'tik_freq', 'use_less_than_2GB', 'use_2GB_to_4GB', 'number_child', 'viettel_no_0', 'viettel_no_1', 'viettel_no_2', 'to_hanoi', 'to_other', 'score', 'number_of_suggestions', 'number_of_plans', 'number_of_accept', 'number_of_accept_2', 'freq', 'accept_rate', 'Smaller_than_6M', '6M_to_12M', '12M_to_20M', 'Higher_than_20M', 'time_morning', 'time_afternoon', 'time_evening', 'time_night'], Scaler applied: True
2025-12-10 17:35:09,284 - INFO - Evaluation started...
2025-12-10 17:35:09,383 - INFO - Evaluation results - Accuracy=0.4389, F1-macro=0.4372, Precision=0.4484, Recall=0.4832
2025-12-10 17:35:09,881 - INFO - ========== Running model: rf ==========
2025-12-10 17:35:09,920 - INFO - Data loaded with shape (5382, 44)
2025-12-10 17:35:09,930 - INFO - Preprocessing created. Will be fitted inside the pipeline. Categorical cols: ['name', 'gender', 'education', 'profession', 'living_with', 'nation', 'phone', 'job', 'marriage_status', 'purpose', 'go_with', 'weather', 'time', 'age_group'], Numerical cols: ['id', 'age', 'income', 'fb_freq', 'yt_freq', 'tik_freq', 'use_less_than_2GB', 'use_2GB_to_4GB', 'number_child', 'viettel_no_0', 'viettel_no_1', 'viettel_no_2', 'to_hanoi', 'to_other', 'score', 'number_of_suggestions', 'number_of_plans', 'number_of_accept', 'number_of_accept_2', 'freq', 'accept_rate', 'Smaller_than_6M', '6M_to_12M', '12M_to_20M', 'Higher_than_20M', 'time_morning', 'time_afternoon', 'time_evening', 'time_night'], Scaler applied: False
2025-12-10 17:35:09,932 - INFO - [FS] Method: SelectKBest | k=40 | score_func=f_classif
2025-12-10 17:35:09,934 - INFO - [FS] Selector created. Will be fitted inside the pipeline.
2025-12-10 17:35:09,950 - INFO - Train shape: (4305, 43), Val shape: (1077, 43)
2025-12-10 17:35:09,979 - INFO - Downsample completed. Before: {3: 1158, 2: 1137, 4: 1018, 0: 542, 1: 450} | After: {0: 450, 1: 450, 2: 450, 3: 450, 4: 450}
2025-12-10 17:35:09,981 - INFO - Pipeline built successfully. Steps: ['preprocessor', 'selector', 'classifier']
2025-12-10 17:35:09,983 - INFO - Training started on 2250 samples using model=RF.
2025-12-10 17:35:11,347 - INFO - Training completed in 1.36 seconds.
2025-12-10 17:35:11,349 - INFO - Hyperparameter search started. Method=RANDOM, Scoring=f1_macro
2025-12-10 17:35:59,619 - INFO - Hyperparameter optimization completed. Best params: {'classifier__n_estimators': 300, 'classifier__min_samples_split': 10, 'classifier__min_samples_leaf': 1, 'classifier__max_depth': 20}
2025-12-10 17:35:59,625 - INFO - Retrain rf after optimization...
2025-12-10 17:35:59,631 - INFO - Pipeline built successfully. Steps: ['preprocessor', 'selector', 'classifier']
2025-12-10 17:35:59,635 - INFO - Training started on 2250 samples using model=RF.
2025-12-10 17:36:00,999 - INFO - Training completed in 1.36 seconds.
2025-12-10 17:36:01,004 - INFO - Preprocessing created. Will be fitted inside the pipeline. Categorical cols: ['name', 'gender', 'education', 'profession', 'living_with', 'nation', 'phone', 'job', 'marriage_status', 'purpose', 'go_with', 'weather', 'time', 'age_group'], Numerical cols: ['id', 'age', 'income', 'fb_freq', 'yt_freq', 'tik_freq', 'use_less_than_2GB', 'use_2GB_to_4GB', 'number_child', 'viettel_no_0', 'viettel_no_1', 'viettel_no_2', 'to_hanoi', 'to_other', 'score', 'number_of_suggestions', 'number_of_plans', 'number_of_accept', 'number_of_accept_2', 'freq', 'accept_rate', 'Smaller_than_6M', '6M_to_12M', '12M_to_20M', 'Higher_than_20M', 'time_morning', 'time_afternoon', 'time_evening', 'time_night'], Scaler applied: False
2025-12-10 17:36:01,008 - INFO - Evaluation started...
2025-12-10 17:36:01,078 - INFO - Evaluation results - Accuracy=0.5810, F1-macro=0.5526, Precision=0.5440, Recall=0.5769
2025-12-10 17:36:01,573 - INFO - ========== Running model: lgbm ==========
2025-12-10 17:36:01,610 - INFO - Data loaded with shape (5382, 44)
2025-12-10 17:36:01,622 - INFO - Preprocessing created. Will be fitted inside the pipeline. Categorical cols: ['name', 'gender', 'education', 'profession', 'living_with', 'nation', 'phone', 'job', 'marriage_status', 'purpose', 'go_with', 'weather', 'time', 'age_group'], Numerical cols: ['id', 'age', 'income', 'fb_freq', 'yt_freq', 'tik_freq', 'use_less_than_2GB', 'use_2GB_to_4GB', 'number_child', 'viettel_no_0', 'viettel_no_1', 'viettel_no_2', 'to_hanoi', 'to_other', 'score', 'number_of_suggestions', 'number_of_plans', 'number_of_accept', 'number_of_accept_2', 'freq', 'accept_rate', 'Smaller_than_6M', '6M_to_12M', '12M_to_20M', 'Higher_than_20M', 'time_morning', 'time_afternoon', 'time_evening', 'time_night'], Scaler applied: False
2025-12-10 17:36:01,624 - INFO - [FS] Method: SelectKBest | k=40 | score_func=f_classif
2025-12-10 17:36:01,625 - INFO - [FS] Selector created. Will be fitted inside the pipeline.
2025-12-10 17:36:01,640 - INFO - Train shape: (4305, 43), Val shape: (1077, 43)
2025-12-10 17:36:01,664 - INFO - Downsample completed. Before: {3: 1158, 2: 1137, 4: 1018, 0: 542, 1: 450} | After: {0: 450, 1: 450, 2: 450, 3: 450, 4: 450}
2025-12-10 17:36:01,666 - INFO - Pipeline built successfully. Steps: ['preprocessor', 'selector', 'classifier']
2025-12-10 17:36:01,668 - INFO - Training started on 2250 samples using model=LGBM.
2025-12-10 17:36:02,106 - INFO - Training completed in 0.44 seconds.
2025-12-10 17:36:02,108 - INFO - Hyperparameter search started. Method=RANDOM, Scoring=f1_macro
2025-12-10 17:36:35,289 - INFO - Hyperparameter optimization completed. Best params: {'classifier__num_leaves': 31, 'classifier__n_estimators': 300, 'classifier__max_depth': 20, 'classifier__learning_rate': 0.05}
2025-12-10 17:36:35,293 - INFO - Retrain lgbm after optimization...
2025-12-10 17:36:35,300 - INFO - Pipeline built successfully. Steps: ['preprocessor', 'selector', 'classifier']
2025-12-10 17:36:35,303 - INFO - Training started on 2250 samples using model=LGBM.
2025-12-10 17:36:35,942 - INFO - Training completed in 0.64 seconds.
2025-12-10 17:36:35,947 - INFO - Preprocessing created. Will be fitted inside the pipeline. Categorical cols: ['name', 'gender', 'education', 'profession', 'living_with', 'nation', 'phone', 'job', 'marriage_status', 'purpose', 'go_with', 'weather', 'time', 'age_group'], Numerical cols: ['id', 'age', 'income', 'fb_freq', 'yt_freq', 'tik_freq', 'use_less_than_2GB', 'use_2GB_to_4GB', 'number_child', 'viettel_no_0', 'viettel_no_1', 'viettel_no_2', 'to_hanoi', 'to_other', 'score', 'number_of_suggestions', 'number_of_plans', 'number_of_accept', 'number_of_accept_2', 'freq', 'accept_rate', 'Smaller_than_6M', '6M_to_12M', '12M_to_20M', 'Higher_than_20M', 'time_morning', 'time_afternoon', 'time_evening', 'time_night'], Scaler applied: False
2025-12-10 17:36:35,949 - INFO - Evaluation started...
2025-12-10 17:36:36,015 - INFO - Evaluation results - Accuracy=0.5262, F1-macro=0.5045, Precision=0.4968, Recall=0.5281
2025-12-10 17:36:36,704 - INFO - ========== Running model: xgb ==========
2025-12-10 17:36:36,760 - INFO - Data loaded with shape (5382, 44)
2025-12-10 17:36:36,774 - INFO - Preprocessing created. Will be fitted inside the pipeline. Categorical cols: ['name', 'gender', 'education', 'profession', 'living_with', 'nation', 'phone', 'job', 'marriage_status', 'purpose', 'go_with', 'weather', 'time', 'age_group'], Numerical cols: ['id', 'age', 'income', 'fb_freq', 'yt_freq', 'tik_freq', 'use_less_than_2GB', 'use_2GB_to_4GB', 'number_child', 'viettel_no_0', 'viettel_no_1', 'viettel_no_2', 'to_hanoi', 'to_other', 'score', 'number_of_suggestions', 'number_of_plans', 'number_of_accept', 'number_of_accept_2', 'freq', 'accept_rate', 'Smaller_than_6M', '6M_to_12M', '12M_to_20M', 'Higher_than_20M', 'time_morning', 'time_afternoon', 'time_evening', 'time_night'], Scaler applied: False
2025-12-10 17:36:36,776 - INFO - [FS] Method: SelectKBest | k=40 | score_func=f_classif
2025-12-10 17:36:36,779 - INFO - [FS] Selector created. Will be fitted inside the pipeline.
2025-12-10 17:36:36,799 - INFO - Train shape: (4305, 43), Val shape: (1077, 43)
2025-12-10 17:36:36,837 - INFO - Downsample completed. Before: {3: 1158, 2: 1137, 4: 1018, 0: 542, 1: 450} | After: {0: 450, 1: 450, 2: 450, 3: 450, 4: 450}
2025-12-10 17:36:36,842 - INFO - Pipeline built successfully. Steps: ['preprocessor', 'selector', 'classifier']
2025-12-10 17:36:36,844 - INFO - Training started on 2250 samples using model=XGB.
2025-12-10 17:36:37,913 - INFO - Training completed in 1.07 seconds.
2025-12-10 17:36:37,918 - INFO - Hyperparameter search started. Method=RANDOM, Scoring=f1_macro
2025-12-10 17:37:28,807 - INFO - Hyperparameter optimization completed. Best params: {'classifier__subsample': 0.6, 'classifier__n_estimators': 700, 'classifier__max_depth': 12, 'classifier__learning_rate': 0.001, 'classifier__colsample_bytree': 0.8}
2025-12-10 17:37:28,811 - INFO - Retrain xgb after optimization...
2025-12-10 17:37:28,819 - INFO - Pipeline built successfully. Steps: ['preprocessor', 'selector', 'classifier']
2025-12-10 17:37:28,820 - INFO - Training started on 2250 samples using model=XGB.
2025-12-10 17:37:29,879 - INFO - Training completed in 1.06 seconds.
2025-12-10 17:37:29,889 - INFO - Preprocessing created. Will be fitted inside the pipeline. Categorical cols: ['name', 'gender', 'education', 'profession', 'living_with', 'nation', 'phone', 'job', 'marriage_status', 'purpose', 'go_with', 'weather', 'time', 'age_group'], Numerical cols: ['id', 'age', 'income', 'fb_freq', 'yt_freq', 'tik_freq', 'use_less_than_2GB', 'use_2GB_to_4GB', 'number_child', 'viettel_no_0', 'viettel_no_1', 'viettel_no_2', 'to_hanoi', 'to_other', 'score', 'number_of_suggestions', 'number_of_plans', 'number_of_accept', 'number_of_accept_2', 'freq', 'accept_rate', 'Smaller_than_6M', '6M_to_12M', '12M_to_20M', 'Higher_than_20M', 'time_morning', 'time_afternoon', 'time_evening', 'time_night'], Scaler applied: False
2025-12-10 17:37:29,894 - INFO - Evaluation started...
2025-12-10 17:37:30,002 - INFO - Evaluation results - Accuracy=0.5536, F1-macro=0.5294, Precision=0.5204, Recall=0.5512
2025-12-10 17:37:30,728 - INFO - ========== Running model: cat ==========
2025-12-10 17:37:30,781 - INFO - Data loaded with shape (5382, 44)
2025-12-10 17:37:30,796 - INFO - Preprocessing created. Will be fitted inside the pipeline. Categorical cols: ['name', 'gender', 'education', 'profession', 'living_with', 'nation', 'phone', 'job', 'marriage_status', 'purpose', 'go_with', 'weather', 'time', 'age_group'], Numerical cols: ['id', 'age', 'income', 'fb_freq', 'yt_freq', 'tik_freq', 'use_less_than_2GB', 'use_2GB_to_4GB', 'number_child', 'viettel_no_0', 'viettel_no_1', 'viettel_no_2', 'to_hanoi', 'to_other', 'score', 'number_of_suggestions', 'number_of_plans', 'number_of_accept', 'number_of_accept_2', 'freq', 'accept_rate', 'Smaller_than_6M', '6M_to_12M', '12M_to_20M', 'Higher_than_20M', 'time_morning', 'time_afternoon', 'time_evening', 'time_night'], Scaler applied: False
2025-12-10 17:37:30,798 - INFO - [FS] Method: SelectKBest | k=40 | score_func=f_classif
2025-12-10 17:37:30,802 - INFO - [FS] Selector created. Will be fitted inside the pipeline.
2025-12-10 17:37:30,820 - INFO - Train shape: (4305, 43), Val shape: (1077, 43)
2025-12-10 17:37:30,858 - INFO - Downsample completed. Before: {3: 1158, 2: 1137, 4: 1018, 0: 542, 1: 450} | After: {0: 450, 1: 450, 2: 450, 3: 450, 4: 450}
2025-12-10 17:37:30,863 - INFO - Pipeline built successfully. Steps: ['preprocessor', 'selector', 'classifier']
2025-12-10 17:37:30,866 - INFO - Training started on 2250 samples using model=CAT.
2025-12-10 17:37:38,257 - INFO - Training completed in 7.39 seconds.
2025-12-10 17:37:38,260 - INFO - Hyperparameter search started. Method=RANDOM, Scoring=f1_macro
2025-12-10 17:41:44,240 - INFO - Hyperparameter optimization completed. Best params: {'classifier__learning_rate': 0.001, 'classifier__l2_leaf_reg': 1, 'classifier__iterations': 700, 'classifier__depth': 8}
2025-12-10 17:41:44,244 - INFO - Retrain cat after optimization...
2025-12-10 17:41:44,252 - INFO - Pipeline built successfully. Steps: ['preprocessor', 'selector', 'classifier']
2025-12-10 17:41:44,260 - INFO - Training started on 2250 samples using model=CAT.
2025-12-10 17:41:51,133 - INFO - Training completed in 6.87 seconds.
2025-12-10 17:41:51,142 - INFO - Preprocessing created. Will be fitted inside the pipeline. Categorical cols: ['name', 'gender', 'education', 'profession', 'living_with', 'nation', 'phone', 'job', 'marriage_status', 'purpose', 'go_with', 'weather', 'time', 'age_group'], Numerical cols: ['id', 'age', 'income', 'fb_freq', 'yt_freq', 'tik_freq', 'use_less_than_2GB', 'use_2GB_to_4GB', 'number_child', 'viettel_no_0', 'viettel_no_1', 'viettel_no_2', 'to_hanoi', 'to_other', 'score', 'number_of_suggestions', 'number_of_plans', 'number_of_accept', 'number_of_accept_2', 'freq', 'accept_rate', 'Smaller_than_6M', '6M_to_12M', '12M_to_20M', 'Higher_than_20M', 'time_morning', 'time_afternoon', 'time_evening', 'time_night'], Scaler applied: False
2025-12-10 17:41:51,146 - INFO - Evaluation started...
2025-12-10 17:41:51,210 - INFO - Evaluation results - Accuracy=0.5411, F1-macro=0.5300, Precision=0.5199, Recall=0.5591
2025-12-10 17:43:55,835 - INFO - ========== Running model: lr ==========
2025-12-10 17:43:55,916 - INFO - Data loaded with shape (5382, 44)
2025-12-10 17:43:55,927 - INFO - Preprocessing created. Will be fitted inside the pipeline. Categorical cols: ['name', 'gender', 'education', 'profession', 'living_with', 'nation', 'phone', 'job', 'marriage_status', 'purpose', 'go_with', 'weather', 'time', 'age_group'], Numerical cols: ['id', 'age', 'income', 'fb_freq', 'yt_freq', 'tik_freq', 'use_less_than_2GB', 'use_2GB_to_4GB', 'number_child', 'viettel_no_0', 'viettel_no_1', 'viettel_no_2', 'to_hanoi', 'to_other', 'score', 'number_of_suggestions', 'number_of_plans', 'number_of_accept', 'number_of_accept_2', 'freq', 'accept_rate', 'Smaller_than_6M', '6M_to_12M', '12M_to_20M', 'Higher_than_20M', 'time_morning', 'time_afternoon', 'time_evening', 'time_night'], Scaler applied: True
2025-12-10 17:43:55,929 - INFO - [FS] Method: SelectKBest | k=40 | score_func=f_classif
2025-12-10 17:43:55,930 - INFO - [FS] Selector created. Will be fitted inside the pipeline.
2025-12-10 17:43:55,947 - INFO - Train shape: (4305, 43), Val shape: (1077, 43)
2025-12-10 17:43:55,998 - INFO - Downsample completed. Before: {3: 1158, 2: 1137, 4: 1018, 0: 542, 1: 450} | After: {0: 450, 1: 450, 2: 450, 3: 450, 4: 450}
2025-12-10 17:43:56,021 - INFO - Pipeline built successfully. Steps: ['preprocessor', 'selector', 'classifier']
2025-12-10 17:43:56,032 - INFO - Training started on 2250 samples using model=LR.
2025-12-10 17:43:56,520 - INFO - Training completed in 0.48 seconds.
2025-12-10 17:43:56,522 - INFO - Hyperparameter search started. Method=RANDOM, Scoring=f1_macro
2025-12-10 17:44:16,944 - INFO - Hyperparameter optimization completed. Best params: {'classifier__solver': 'saga', 'classifier__max_iter': 300, 'classifier__C': 0.1}
2025-12-10 17:44:16,946 - INFO - Retrain lr after optimization...
2025-12-10 17:44:16,948 - INFO - Pipeline built successfully. Steps: ['preprocessor', 'selector', 'classifier']
2025-12-10 17:44:16,949 - INFO - Training started on 2250 samples using model=LR.
2025-12-10 17:44:17,246 - INFO - Training completed in 0.30 seconds.
2025-12-10 17:44:17,251 - INFO - Preprocessing created. Will be fitted inside the pipeline. Categorical cols: ['name', 'gender', 'education', 'profession', 'living_with', 'nation', 'phone', 'job', 'marriage_status', 'purpose', 'go_with', 'weather', 'time', 'age_group'], Numerical cols: ['id', 'age', 'income', 'fb_freq', 'yt_freq', 'tik_freq', 'use_less_than_2GB', 'use_2GB_to_4GB', 'number_child', 'viettel_no_0', 'viettel_no_1', 'viettel_no_2', 'to_hanoi', 'to_other', 'score', 'number_of_suggestions', 'number_of_plans', 'number_of_accept', 'number_of_accept_2', 'freq', 'accept_rate', 'Smaller_than_6M', '6M_to_12M', '12M_to_20M', 'Higher_than_20M', 'time_morning', 'time_afternoon', 'time_evening', 'time_night'], Scaler applied: True
2025-12-10 17:44:17,254 - INFO - Evaluation started...
2025-12-10 17:44:17,301 - INFO - Evaluation results - Accuracy=0.4015, F1-macro=0.3814, Precision=0.3773, Recall=0.3960
2025-12-10 17:44:17,780 - INFO - ========== Running model: svm ==========
2025-12-10 17:44:17,814 - INFO - Data loaded with shape (5382, 44)
2025-12-10 17:44:17,824 - INFO - Preprocessing created. Will be fitted inside the pipeline. Categorical cols: ['name', 'gender', 'education', 'profession', 'living_with', 'nation', 'phone', 'job', 'marriage_status', 'purpose', 'go_with', 'weather', 'time', 'age_group'], Numerical cols: ['id', 'age', 'income', 'fb_freq', 'yt_freq', 'tik_freq', 'use_less_than_2GB', 'use_2GB_to_4GB', 'number_child', 'viettel_no_0', 'viettel_no_1', 'viettel_no_2', 'to_hanoi', 'to_other', 'score', 'number_of_suggestions', 'number_of_plans', 'number_of_accept', 'number_of_accept_2', 'freq', 'accept_rate', 'Smaller_than_6M', '6M_to_12M', '12M_to_20M', 'Higher_than_20M', 'time_morning', 'time_afternoon', 'time_evening', 'time_night'], Scaler applied: True
2025-12-10 17:44:17,826 - INFO - [FS] Method: SelectKBest | k=40 | score_func=f_classif
2025-12-10 17:44:17,827 - INFO - [FS] Selector created. Will be fitted inside the pipeline.
2025-12-10 17:44:17,841 - INFO - Train shape: (4305, 43), Val shape: (1077, 43)
2025-12-10 17:44:17,865 - INFO - Downsample completed. Before: {3: 1158, 2: 1137, 4: 1018, 0: 542, 1: 450} | After: {0: 450, 1: 450, 2: 450, 3: 450, 4: 450}
2025-12-10 17:44:17,867 - INFO - Pipeline built successfully. Steps: ['preprocessor', 'selector', 'classifier']
2025-12-10 17:44:17,869 - INFO - Training started on 2250 samples using model=SVM.
2025-12-10 17:44:20,308 - INFO - Training completed in 2.44 seconds.
2025-12-10 17:44:20,312 - INFO - Hyperparameter search started. Method=RANDOM, Scoring=f1_macro
2025-12-10 17:46:35,864 - INFO - Hyperparameter optimization completed. Best params: {'classifier__kernel': 'rbf', 'classifier__gamma': 'auto', 'classifier__C': 10.0}
2025-12-10 17:46:35,867 - INFO - Retrain svm after optimization...
2025-12-10 17:46:35,870 - INFO - Pipeline built successfully. Steps: ['preprocessor', 'selector', 'classifier']
2025-12-10 17:46:35,873 - INFO - Training started on 2250 samples using model=SVM.
2025-12-10 17:46:38,341 - INFO - Training completed in 2.47 seconds.
2025-12-10 17:46:38,348 - INFO - Preprocessing created. Will be fitted inside the pipeline. Categorical cols: ['name', 'gender', 'education', 'profession', 'living_with', 'nation', 'phone', 'job', 'marriage_status', 'purpose', 'go_with', 'weather', 'time', 'age_group'], Numerical cols: ['id', 'age', 'income', 'fb_freq', 'yt_freq', 'tik_freq', 'use_less_than_2GB', 'use_2GB_to_4GB', 'number_child', 'viettel_no_0', 'viettel_no_1', 'viettel_no_2', 'to_hanoi', 'to_other', 'score', 'number_of_suggestions', 'number_of_plans', 'number_of_accept', 'number_of_accept_2', 'freq', 'accept_rate', 'Smaller_than_6M', '6M_to_12M', '12M_to_20M', 'Higher_than_20M', 'time_morning', 'time_afternoon', 'time_evening', 'time_night'], Scaler applied: True
2025-12-10 17:46:38,352 - INFO - Evaluation started...
2025-12-10 17:46:38,463 - INFO - Evaluation results - Accuracy=0.4389, F1-macro=0.4372, Precision=0.4484, Recall=0.4832
2025-12-10 17:46:39,219 - INFO - ========== Running model: rf ==========
2025-12-10 17:46:39,261 - INFO - Data loaded with shape (5382, 44)
2025-12-10 17:46:39,270 - INFO - Preprocessing created. Will be fitted inside the pipeline. Categorical cols: ['name', 'gender', 'education', 'profession', 'living_with', 'nation', 'phone', 'job', 'marriage_status', 'purpose', 'go_with', 'weather', 'time', 'age_group'], Numerical cols: ['id', 'age', 'income', 'fb_freq', 'yt_freq', 'tik_freq', 'use_less_than_2GB', 'use_2GB_to_4GB', 'number_child', 'viettel_no_0', 'viettel_no_1', 'viettel_no_2', 'to_hanoi', 'to_other', 'score', 'number_of_suggestions', 'number_of_plans', 'number_of_accept', 'number_of_accept_2', 'freq', 'accept_rate', 'Smaller_than_6M', '6M_to_12M', '12M_to_20M', 'Higher_than_20M', 'time_morning', 'time_afternoon', 'time_evening', 'time_night'], Scaler applied: False
2025-12-10 17:46:39,273 - INFO - [FS] Method: SelectKBest | k=40 | score_func=f_classif
2025-12-10 17:46:39,275 - INFO - [FS] Selector created. Will be fitted inside the pipeline.
2025-12-10 17:46:39,293 - INFO - Train shape: (4305, 43), Val shape: (1077, 43)
2025-12-10 17:46:39,320 - INFO - Downsample completed. Before: {3: 1158, 2: 1137, 4: 1018, 0: 542, 1: 450} | After: {0: 450, 1: 450, 2: 450, 3: 450, 4: 450}
2025-12-10 17:46:39,322 - INFO - Pipeline built successfully. Steps: ['preprocessor', 'selector', 'classifier']
2025-12-10 17:46:39,325 - INFO - Training started on 2250 samples using model=RF.
2025-12-10 17:46:40,713 - INFO - Training completed in 1.39 seconds.
2025-12-10 17:46:40,716 - INFO - Hyperparameter search started. Method=RANDOM, Scoring=f1_macro
2025-12-10 17:48:31,415 - INFO - Hyperparameter optimization completed. Best params: {'classifier__n_estimators': 300, 'classifier__min_samples_split': 10, 'classifier__min_samples_leaf': 1, 'classifier__max_depth': 20}
2025-12-10 17:48:31,418 - INFO - Retrain rf after optimization...
2025-12-10 17:48:31,421 - INFO - Pipeline built successfully. Steps: ['preprocessor', 'selector', 'classifier']
2025-12-10 17:48:31,423 - INFO - Training started on 2250 samples using model=RF.
2025-12-10 17:48:33,368 - INFO - Training completed in 1.94 seconds.
2025-12-10 17:48:33,377 - INFO - Preprocessing created. Will be fitted inside the pipeline. Categorical cols: ['name', 'gender', 'education', 'profession', 'living_with', 'nation', 'phone', 'job', 'marriage_status', 'purpose', 'go_with', 'weather', 'time', 'age_group'], Numerical cols: ['id', 'age', 'income', 'fb_freq', 'yt_freq', 'tik_freq', 'use_less_than_2GB', 'use_2GB_to_4GB', 'number_child', 'viettel_no_0', 'viettel_no_1', 'viettel_no_2', 'to_hanoi', 'to_other', 'score', 'number_of_suggestions', 'number_of_plans', 'number_of_accept', 'number_of_accept_2', 'freq', 'accept_rate', 'Smaller_than_6M', '6M_to_12M', '12M_to_20M', 'Higher_than_20M', 'time_morning', 'time_afternoon', 'time_evening', 'time_night'], Scaler applied: False
2025-12-10 17:48:33,380 - INFO - Evaluation started...
2025-12-10 17:48:33,467 - INFO - Evaluation results - Accuracy=0.5810, F1-macro=0.5526, Precision=0.5440, Recall=0.5769
2025-12-10 17:48:34,179 - INFO - ========== Running model: lgbm ==========
2025-12-10 17:48:34,217 - INFO - Data loaded with shape (5382, 44)
2025-12-10 17:48:34,227 - INFO - Preprocessing created. Will be fitted inside the pipeline. Categorical cols: ['name', 'gender', 'education', 'profession', 'living_with', 'nation', 'phone', 'job', 'marriage_status', 'purpose', 'go_with', 'weather', 'time', 'age_group'], Numerical cols: ['id', 'age', 'income', 'fb_freq', 'yt_freq', 'tik_freq', 'use_less_than_2GB', 'use_2GB_to_4GB', 'number_child', 'viettel_no_0', 'viettel_no_1', 'viettel_no_2', 'to_hanoi', 'to_other', 'score', 'number_of_suggestions', 'number_of_plans', 'number_of_accept', 'number_of_accept_2', 'freq', 'accept_rate', 'Smaller_than_6M', '6M_to_12M', '12M_to_20M', 'Higher_than_20M', 'time_morning', 'time_afternoon', 'time_evening', 'time_night'], Scaler applied: False
2025-12-10 17:48:34,230 - INFO - [FS] Method: SelectKBest | k=40 | score_func=f_classif
2025-12-10 17:48:34,232 - INFO - [FS] Selector created. Will be fitted inside the pipeline.
2025-12-10 17:48:34,251 - INFO - Train shape: (4305, 43), Val shape: (1077, 43)
2025-12-10 17:48:34,277 - INFO - Downsample completed. Before: {3: 1158, 2: 1137, 4: 1018, 0: 542, 1: 450} | After: {0: 450, 1: 450, 2: 450, 3: 450, 4: 450}
2025-12-10 17:48:34,281 - INFO - Pipeline built successfully. Steps: ['preprocessor', 'selector', 'classifier']
2025-12-10 17:48:34,283 - INFO - Training started on 2250 samples using model=LGBM.
2025-12-10 17:48:34,728 - INFO - Training completed in 0.44 seconds.
2025-12-10 17:48:34,730 - INFO - Hyperparameter search started. Method=RANDOM, Scoring=f1_macro
2025-12-10 17:49:55,117 - INFO - Hyperparameter optimization completed. Best params: {'classifier__num_leaves': 31, 'classifier__n_estimators': 100, 'classifier__max_depth': 10, 'classifier__learning_rate': 0.1}
2025-12-10 17:49:55,120 - INFO - Retrain lgbm after optimization...
2025-12-10 17:49:55,125 - INFO - Pipeline built successfully. Steps: ['preprocessor', 'selector', 'classifier']
2025-12-10 17:49:55,130 - INFO - Training started on 2250 samples using model=LGBM.
2025-12-10 17:49:55,547 - INFO - Training completed in 0.41 seconds.
2025-12-10 17:49:55,554 - INFO - Preprocessing created. Will be fitted inside the pipeline. Categorical cols: ['name', 'gender', 'education', 'profession', 'living_with', 'nation', 'phone', 'job', 'marriage_status', 'purpose', 'go_with', 'weather', 'time', 'age_group'], Numerical cols: ['id', 'age', 'income', 'fb_freq', 'yt_freq', 'tik_freq', 'use_less_than_2GB', 'use_2GB_to_4GB', 'number_child', 'viettel_no_0', 'viettel_no_1', 'viettel_no_2', 'to_hanoi', 'to_other', 'score', 'number_of_suggestions', 'number_of_plans', 'number_of_accept', 'number_of_accept_2', 'freq', 'accept_rate', 'Smaller_than_6M', '6M_to_12M', '12M_to_20M', 'Higher_than_20M', 'time_morning', 'time_afternoon', 'time_evening', 'time_night'], Scaler applied: False
2025-12-10 17:49:55,560 - INFO - Evaluation started...
2025-12-10 17:49:55,644 - INFO - Evaluation results - Accuracy=0.5262, F1-macro=0.5045, Precision=0.4968, Recall=0.5281
2025-12-10 17:49:56,111 - INFO - ========== Running model: xgb ==========
2025-12-10 17:49:56,151 - INFO - Data loaded with shape (5382, 44)
2025-12-10 17:49:56,162 - INFO - Preprocessing created. Will be fitted inside the pipeline. Categorical cols: ['name', 'gender', 'education', 'profession', 'living_with', 'nation', 'phone', 'job', 'marriage_status', 'purpose', 'go_with', 'weather', 'time', 'age_group'], Numerical cols: ['id', 'age', 'income', 'fb_freq', 'yt_freq', 'tik_freq', 'use_less_than_2GB', 'use_2GB_to_4GB', 'number_child', 'viettel_no_0', 'viettel_no_1', 'viettel_no_2', 'to_hanoi', 'to_other', 'score', 'number_of_suggestions', 'number_of_plans', 'number_of_accept', 'number_of_accept_2', 'freq', 'accept_rate', 'Smaller_than_6M', '6M_to_12M', '12M_to_20M', 'Higher_than_20M', 'time_morning', 'time_afternoon', 'time_evening', 'time_night'], Scaler applied: False
2025-12-10 17:49:56,163 - INFO - [FS] Method: SelectKBest | k=40 | score_func=f_classif
2025-12-10 17:49:56,166 - INFO - [FS] Selector created. Will be fitted inside the pipeline.
2025-12-10 17:49:56,183 - INFO - Train shape: (4305, 43), Val shape: (1077, 43)
2025-12-10 17:49:56,211 - INFO - Downsample completed. Before: {3: 1158, 2: 1137, 4: 1018, 0: 542, 1: 450} | After: {0: 450, 1: 450, 2: 450, 3: 450, 4: 450}
2025-12-10 17:49:56,214 - INFO - Pipeline built successfully. Steps: ['preprocessor', 'selector', 'classifier']
2025-12-10 17:49:56,216 - INFO - Training started on 2250 samples using model=XGB.
2025-12-10 17:49:56,766 - INFO - Training completed in 0.55 seconds.
2025-12-10 17:49:56,767 - INFO - Hyperparameter search started. Method=RANDOM, Scoring=f1_macro
2025-12-10 17:51:43,463 - INFO - Hyperparameter optimization completed. Best params: {'classifier__subsample': 1.0, 'classifier__n_estimators': 200, 'classifier__max_depth': 6, 'classifier__learning_rate': 0.01, 'classifier__colsample_bytree': 0.6}
2025-12-10 17:51:43,467 - INFO - Retrain xgb after optimization...
2025-12-10 17:51:43,471 - INFO - Pipeline built successfully. Steps: ['preprocessor', 'selector', 'classifier']
2025-12-10 17:51:43,476 - INFO - Training started on 2250 samples using model=XGB.
2025-12-10 17:51:43,953 - INFO - Training completed in 0.48 seconds.
2025-12-10 17:51:43,958 - INFO - Preprocessing created. Will be fitted inside the pipeline. Categorical cols: ['name', 'gender', 'education', 'profession', 'living_with', 'nation', 'phone', 'job', 'marriage_status', 'purpose', 'go_with', 'weather', 'time', 'age_group'], Numerical cols: ['id', 'age', 'income', 'fb_freq', 'yt_freq', 'tik_freq', 'use_less_than_2GB', 'use_2GB_to_4GB', 'number_child', 'viettel_no_0', 'viettel_no_1', 'viettel_no_2', 'to_hanoi', 'to_other', 'score', 'number_of_suggestions', 'number_of_plans', 'number_of_accept', 'number_of_accept_2', 'freq', 'accept_rate', 'Smaller_than_6M', '6M_to_12M', '12M_to_20M', 'Higher_than_20M', 'time_morning', 'time_afternoon', 'time_evening', 'time_night'], Scaler applied: False
2025-12-10 17:51:43,961 - INFO - Evaluation started...
2025-12-10 17:51:44,033 - INFO - Evaluation results - Accuracy=0.5536, F1-macro=0.5294, Precision=0.5204, Recall=0.5512
2025-12-10 17:51:44,522 - INFO - ========== Running model: cat ==========
2025-12-10 17:51:44,560 - INFO - Data loaded with shape (5382, 44)
2025-12-10 17:51:44,569 - INFO - Preprocessing created. Will be fitted inside the pipeline. Categorical cols: ['name', 'gender', 'education', 'profession', 'living_with', 'nation', 'phone', 'job', 'marriage_status', 'purpose', 'go_with', 'weather', 'time', 'age_group'], Numerical cols: ['id', 'age', 'income', 'fb_freq', 'yt_freq', 'tik_freq', 'use_less_than_2GB', 'use_2GB_to_4GB', 'number_child', 'viettel_no_0', 'viettel_no_1', 'viettel_no_2', 'to_hanoi', 'to_other', 'score', 'number_of_suggestions', 'number_of_plans', 'number_of_accept', 'number_of_accept_2', 'freq', 'accept_rate', 'Smaller_than_6M', '6M_to_12M', '12M_to_20M', 'Higher_than_20M', 'time_morning', 'time_afternoon', 'time_evening', 'time_night'], Scaler applied: False
2025-12-10 17:51:44,571 - INFO - [FS] Method: SelectKBest | k=40 | score_func=f_classif
2025-12-10 17:51:44,572 - INFO - [FS] Selector created. Will be fitted inside the pipeline.
2025-12-10 17:51:44,586 - INFO - Train shape: (4305, 43), Val shape: (1077, 43)
2025-12-10 17:51:44,608 - INFO - Downsample completed. Before: {3: 1158, 2: 1137, 4: 1018, 0: 542, 1: 450} | After: {0: 450, 1: 450, 2: 450, 3: 450, 4: 450}
2025-12-10 17:51:44,611 - INFO - Pipeline built successfully. Steps: ['preprocessor', 'selector', 'classifier']
2025-12-10 17:51:44,613 - INFO - Training started on 2250 samples using model=CAT.
2025-12-10 17:51:51,266 - INFO - Training completed in 6.65 seconds.
2025-12-10 17:51:51,268 - INFO - Hyperparameter search started. Method=RANDOM, Scoring=f1_macro
2025-12-10 18:02:23,561 - INFO - Hyperparameter optimization completed. Best params: {'classifier__learning_rate': 0.001, 'classifier__l2_leaf_reg': 3, 'classifier__iterations': 200, 'classifier__depth': 8}
2025-12-10 18:02:23,567 - INFO - Retrain cat after optimization...
2025-12-10 18:02:23,569 - INFO - Pipeline built successfully. Steps: ['preprocessor', 'selector', 'classifier']
2025-12-10 18:02:23,573 - INFO - Training started on 2250 samples using model=CAT.
2025-12-10 18:02:30,237 - INFO - Training completed in 6.66 seconds.
2025-12-10 18:02:30,244 - INFO - Preprocessing created. Will be fitted inside the pipeline. Categorical cols: ['name', 'gender', 'education', 'profession', 'living_with', 'nation', 'phone', 'job', 'marriage_status', 'purpose', 'go_with', 'weather', 'time', 'age_group'], Numerical cols: ['id', 'age', 'income', 'fb_freq', 'yt_freq', 'tik_freq', 'use_less_than_2GB', 'use_2GB_to_4GB', 'number_child', 'viettel_no_0', 'viettel_no_1', 'viettel_no_2', 'to_hanoi', 'to_other', 'score', 'number_of_suggestions', 'number_of_plans', 'number_of_accept', 'number_of_accept_2', 'freq', 'accept_rate', 'Smaller_than_6M', '6M_to_12M', '12M_to_20M', 'Higher_than_20M', 'time_morning', 'time_afternoon', 'time_evening', 'time_night'], Scaler applied: False
2025-12-10 18:02:30,248 - INFO - Evaluation started...
2025-12-10 18:02:30,304 - INFO - Evaluation results - Accuracy=0.5411, F1-macro=0.5300, Precision=0.5199, Recall=0.5591
2025-12-10 18:07:17,130 - INFO - ========== Running model: lr ==========
2025-12-10 18:07:17,344 - INFO - Data loaded with shape (5382, 44)
2025-12-10 18:07:17,396 - INFO - Preprocessing created. Will be fitted inside the pipeline. Categorical cols: ['name', 'gender', 'education', 'profession', 'living_with', 'nation', 'phone', 'job', 'marriage_status', 'purpose', 'go_with', 'weather', 'time', 'age_group'], Numerical cols: ['id', 'age', 'income', 'fb_freq', 'yt_freq', 'tik_freq', 'use_less_than_2GB', 'use_2GB_to_4GB', 'number_child', 'viettel_no_0', 'viettel_no_1', 'viettel_no_2', 'to_hanoi', 'to_other', 'score', 'number_of_suggestions', 'number_of_plans', 'number_of_accept', 'number_of_accept_2', 'freq', 'accept_rate', 'Smaller_than_6M', '6M_to_12M', '12M_to_20M', 'Higher_than_20M', 'time_morning', 'time_afternoon', 'time_evening', 'time_night'], Scaler applied: True
2025-12-10 18:07:17,413 - INFO - [FS] Method: SelectKBest | k=40 | score_func=f_classif
2025-12-10 18:07:17,415 - INFO - [FS] Selector created. Will be fitted inside the pipeline.
2025-12-10 18:07:17,453 - INFO - Train shape: (4305, 43), Val shape: (1077, 43)
2025-12-10 18:07:17,571 - INFO - Downsample completed. Before: {3: 1158, 2: 1137, 4: 1018, 0: 542, 1: 450} | After: {0: 450, 1: 450, 2: 450, 3: 450, 4: 450}
2025-12-10 18:07:17,604 - INFO - Pipeline built successfully. Steps: ['preprocessor', 'selector', 'classifier']
2025-12-10 18:07:17,612 - INFO - Training started on 2250 samples using model=LR.
2025-12-10 18:07:18,095 - INFO - Training completed in 0.47 seconds.
2025-12-10 18:07:18,105 - INFO - Hyperparameter search started. Method=GRID, Scoring=f1_macro
2025-12-10 18:07:22,405 - INFO - Hyperparameter optimization completed. Best params: {'classifier__C': 0.1, 'classifier__max_iter': 500, 'classifier__solver': 'lbfgs'}
2025-12-10 18:07:22,409 - INFO - Retrain lr after optimization...
2025-12-10 18:07:22,417 - INFO - Pipeline built successfully. Steps: ['preprocessor', 'selector', 'classifier']
2025-12-10 18:07:22,420 - INFO - Training started on 2250 samples using model=LR.
2025-12-10 18:07:22,629 - INFO - Training completed in 0.21 seconds.
2025-12-10 18:07:22,639 - INFO - Preprocessing created. Will be fitted inside the pipeline. Categorical cols: ['name', 'gender', 'education', 'profession', 'living_with', 'nation', 'phone', 'job', 'marriage_status', 'purpose', 'go_with', 'weather', 'time', 'age_group'], Numerical cols: ['id', 'age', 'income', 'fb_freq', 'yt_freq', 'tik_freq', 'use_less_than_2GB', 'use_2GB_to_4GB', 'number_child', 'viettel_no_0', 'viettel_no_1', 'viettel_no_2', 'to_hanoi', 'to_other', 'score', 'number_of_suggestions', 'number_of_plans', 'number_of_accept', 'number_of_accept_2', 'freq', 'accept_rate', 'Smaller_than_6M', '6M_to_12M', '12M_to_20M', 'Higher_than_20M', 'time_morning', 'time_afternoon', 'time_evening', 'time_night'], Scaler applied: True
2025-12-10 18:07:22,644 - INFO - Evaluation started...
2025-12-10 18:07:22,694 - INFO - Evaluation results - Accuracy=0.4015, F1-macro=0.3814, Precision=0.3773, Recall=0.3960
2025-12-10 18:07:23,160 - INFO - ========== Running model: svm ==========
2025-12-10 18:07:23,197 - INFO - Data loaded with shape (5382, 44)
2025-12-10 18:07:23,211 - INFO - Preprocessing created. Will be fitted inside the pipeline. Categorical cols: ['name', 'gender', 'education', 'profession', 'living_with', 'nation', 'phone', 'job', 'marriage_status', 'purpose', 'go_with', 'weather', 'time', 'age_group'], Numerical cols: ['id', 'age', 'income', 'fb_freq', 'yt_freq', 'tik_freq', 'use_less_than_2GB', 'use_2GB_to_4GB', 'number_child', 'viettel_no_0', 'viettel_no_1', 'viettel_no_2', 'to_hanoi', 'to_other', 'score', 'number_of_suggestions', 'number_of_plans', 'number_of_accept', 'number_of_accept_2', 'freq', 'accept_rate', 'Smaller_than_6M', '6M_to_12M', '12M_to_20M', 'Higher_than_20M', 'time_morning', 'time_afternoon', 'time_evening', 'time_night'], Scaler applied: True
2025-12-10 18:07:23,212 - INFO - [FS] Method: SelectKBest | k=40 | score_func=f_classif
2025-12-10 18:07:23,214 - INFO - [FS] Selector created. Will be fitted inside the pipeline.
2025-12-10 18:07:23,232 - INFO - Train shape: (4305, 43), Val shape: (1077, 43)
2025-12-10 18:07:23,256 - INFO - Downsample completed. Before: {3: 1158, 2: 1137, 4: 1018, 0: 542, 1: 450} | After: {0: 450, 1: 450, 2: 450, 3: 450, 4: 450}
2025-12-10 18:07:23,258 - INFO - Pipeline built successfully. Steps: ['preprocessor', 'selector', 'classifier']
2025-12-10 18:07:23,261 - INFO - Training started on 2250 samples using model=SVM.
2025-12-10 18:07:25,675 - INFO - Training completed in 2.41 seconds.
2025-12-10 18:07:25,677 - INFO - Hyperparameter search started. Method=GRID, Scoring=f1_macro
2025-12-10 18:07:56,538 - INFO - Hyperparameter optimization completed. Best params: {'classifier__C': 10.0, 'classifier__gamma': 'scale', 'classifier__kernel': 'rbf'}
2025-12-10 18:07:56,540 - INFO - Retrain svm after optimization...
2025-12-10 18:07:56,545 - INFO - Pipeline built successfully. Steps: ['preprocessor', 'selector', 'classifier']
2025-12-10 18:07:56,547 - INFO - Training started on 2250 samples using model=SVM.
2025-12-10 18:07:59,800 - INFO - Training completed in 3.25 seconds.
2025-12-10 18:07:59,808 - INFO - Preprocessing created. Will be fitted inside the pipeline. Categorical cols: ['name', 'gender', 'education', 'profession', 'living_with', 'nation', 'phone', 'job', 'marriage_status', 'purpose', 'go_with', 'weather', 'time', 'age_group'], Numerical cols: ['id', 'age', 'income', 'fb_freq', 'yt_freq', 'tik_freq', 'use_less_than_2GB', 'use_2GB_to_4GB', 'number_child', 'viettel_no_0', 'viettel_no_1', 'viettel_no_2', 'to_hanoi', 'to_other', 'score', 'number_of_suggestions', 'number_of_plans', 'number_of_accept', 'number_of_accept_2', 'freq', 'accept_rate', 'Smaller_than_6M', '6M_to_12M', '12M_to_20M', 'Higher_than_20M', 'time_morning', 'time_afternoon', 'time_evening', 'time_night'], Scaler applied: True
2025-12-10 18:07:59,810 - INFO - Evaluation started...
2025-12-10 18:07:59,959 - INFO - Evaluation results - Accuracy=0.4389, F1-macro=0.4372, Precision=0.4484, Recall=0.4832
2025-12-10 18:08:00,641 - INFO - ========== Running model: rf ==========
2025-12-10 18:08:00,677 - INFO - Data loaded with shape (5382, 44)
2025-12-10 18:08:00,688 - INFO - Preprocessing created. Will be fitted inside the pipeline. Categorical cols: ['name', 'gender', 'education', 'profession', 'living_with', 'nation', 'phone', 'job', 'marriage_status', 'purpose', 'go_with', 'weather', 'time', 'age_group'], Numerical cols: ['id', 'age', 'income', 'fb_freq', 'yt_freq', 'tik_freq', 'use_less_than_2GB', 'use_2GB_to_4GB', 'number_child', 'viettel_no_0', 'viettel_no_1', 'viettel_no_2', 'to_hanoi', 'to_other', 'score', 'number_of_suggestions', 'number_of_plans', 'number_of_accept', 'number_of_accept_2', 'freq', 'accept_rate', 'Smaller_than_6M', '6M_to_12M', '12M_to_20M', 'Higher_than_20M', 'time_morning', 'time_afternoon', 'time_evening', 'time_night'], Scaler applied: False
2025-12-10 18:08:00,692 - INFO - [FS] Method: SelectKBest | k=40 | score_func=f_classif
2025-12-10 18:08:00,693 - INFO - [FS] Selector created. Will be fitted inside the pipeline.
2025-12-10 18:08:00,710 - INFO - Train shape: (4305, 43), Val shape: (1077, 43)
2025-12-10 18:08:00,734 - INFO - Downsample completed. Before: {3: 1158, 2: 1137, 4: 1018, 0: 542, 1: 450} | After: {0: 450, 1: 450, 2: 450, 3: 450, 4: 450}
2025-12-10 18:08:00,736 - INFO - Pipeline built successfully. Steps: ['preprocessor', 'selector', 'classifier']
2025-12-10 18:08:00,737 - INFO - Training started on 2250 samples using model=RF.
2025-12-10 18:08:02,114 - INFO - Training completed in 1.38 seconds.
2025-12-10 18:08:02,116 - INFO - Hyperparameter search started. Method=GRID, Scoring=f1_macro
2025-12-10 18:10:23,295 - INFO - Hyperparameter optimization completed. Best params: {'classifier__max_depth': 20, 'classifier__min_samples_leaf': 1, 'classifier__min_samples_split': 10, 'classifier__n_estimators': 200}
2025-12-10 18:10:23,299 - INFO - Retrain rf after optimization...
2025-12-10 18:10:23,304 - INFO - Pipeline built successfully. Steps: ['preprocessor', 'selector', 'classifier']
2025-12-10 18:10:23,308 - INFO - Training started on 2250 samples using model=RF.
2025-12-10 18:10:25,236 - INFO - Training completed in 1.93 seconds.
2025-12-10 18:10:25,244 - INFO - Preprocessing created. Will be fitted inside the pipeline. Categorical cols: ['name', 'gender', 'education', 'profession', 'living_with', 'nation', 'phone', 'job', 'marriage_status', 'purpose', 'go_with', 'weather', 'time', 'age_group'], Numerical cols: ['id', 'age', 'income', 'fb_freq', 'yt_freq', 'tik_freq', 'use_less_than_2GB', 'use_2GB_to_4GB', 'number_child', 'viettel_no_0', 'viettel_no_1', 'viettel_no_2', 'to_hanoi', 'to_other', 'score', 'number_of_suggestions', 'number_of_plans', 'number_of_accept', 'number_of_accept_2', 'freq', 'accept_rate', 'Smaller_than_6M', '6M_to_12M', '12M_to_20M', 'Higher_than_20M', 'time_morning', 'time_afternoon', 'time_evening', 'time_night'], Scaler applied: False
2025-12-10 18:10:25,247 - INFO - Evaluation started...
2025-12-10 18:10:25,346 - INFO - Evaluation results - Accuracy=0.5810, F1-macro=0.5526, Precision=0.5440, Recall=0.5769
2025-12-10 18:10:25,976 - INFO - ========== Running model: lgbm ==========
2025-12-10 18:10:26,028 - INFO - Data loaded with shape (5382, 44)
2025-12-10 18:10:26,041 - INFO - Preprocessing created. Will be fitted inside the pipeline. Categorical cols: ['name', 'gender', 'education', 'profession', 'living_with', 'nation', 'phone', 'job', 'marriage_status', 'purpose', 'go_with', 'weather', 'time', 'age_group'], Numerical cols: ['id', 'age', 'income', 'fb_freq', 'yt_freq', 'tik_freq', 'use_less_than_2GB', 'use_2GB_to_4GB', 'number_child', 'viettel_no_0', 'viettel_no_1', 'viettel_no_2', 'to_hanoi', 'to_other', 'score', 'number_of_suggestions', 'number_of_plans', 'number_of_accept', 'number_of_accept_2', 'freq', 'accept_rate', 'Smaller_than_6M', '6M_to_12M', '12M_to_20M', 'Higher_than_20M', 'time_morning', 'time_afternoon', 'time_evening', 'time_night'], Scaler applied: False
2025-12-10 18:10:26,045 - INFO - [FS] Method: SelectKBest | k=40 | score_func=f_classif
2025-12-10 18:10:26,050 - INFO - [FS] Selector created. Will be fitted inside the pipeline.
2025-12-10 18:10:26,068 - INFO - Train shape: (4305, 43), Val shape: (1077, 43)
2025-12-10 18:10:26,097 - INFO - Downsample completed. Before: {3: 1158, 2: 1137, 4: 1018, 0: 542, 1: 450} | After: {0: 450, 1: 450, 2: 450, 3: 450, 4: 450}
2025-12-10 18:10:26,100 - INFO - Pipeline built successfully. Steps: ['preprocessor', 'selector', 'classifier']
2025-12-10 18:10:26,103 - INFO - Training started on 2250 samples using model=LGBM.
2025-12-10 18:10:26,553 - INFO - Training completed in 0.45 seconds.
2025-12-10 18:10:26,556 - INFO - Hyperparameter search started. Method=GRID, Scoring=f1_macro
2025-12-10 18:12:06,661 - INFO - Hyperparameter optimization completed. Best params: {'classifier__learning_rate': 0.05, 'classifier__max_depth': -1, 'classifier__n_estimators': 300, 'classifier__num_leaves': 20}
2025-12-10 18:12:06,665 - INFO - Retrain lgbm after optimization...
2025-12-10 18:12:06,676 - INFO - Pipeline built successfully. Steps: ['preprocessor', 'selector', 'classifier']
2025-12-10 18:12:06,679 - INFO - Training started on 2250 samples using model=LGBM.
2025-12-10 18:12:07,098 - INFO - Training completed in 0.41 seconds.
2025-12-10 18:12:07,103 - INFO - Preprocessing created. Will be fitted inside the pipeline. Categorical cols: ['name', 'gender', 'education', 'profession', 'living_with', 'nation', 'phone', 'job', 'marriage_status', 'purpose', 'go_with', 'weather', 'time', 'age_group'], Numerical cols: ['id', 'age', 'income', 'fb_freq', 'yt_freq', 'tik_freq', 'use_less_than_2GB', 'use_2GB_to_4GB', 'number_child', 'viettel_no_0', 'viettel_no_1', 'viettel_no_2', 'to_hanoi', 'to_other', 'score', 'number_of_suggestions', 'number_of_plans', 'number_of_accept', 'number_of_accept_2', 'freq', 'accept_rate', 'Smaller_than_6M', '6M_to_12M', '12M_to_20M', 'Higher_than_20M', 'time_morning', 'time_afternoon', 'time_evening', 'time_night'], Scaler applied: False
2025-12-10 18:12:07,107 - INFO - Evaluation started...
2025-12-10 18:12:07,182 - INFO - Evaluation results - Accuracy=0.5262, F1-macro=0.5045, Precision=0.4968, Recall=0.5281
2025-12-10 18:12:07,905 - INFO - ========== Running model: xgb ==========
2025-12-10 18:12:07,945 - INFO - Data loaded with shape (5382, 44)
2025-12-10 18:12:07,961 - INFO - Preprocessing created. Will be fitted inside the pipeline. Categorical cols: ['name', 'gender', 'education', 'profession', 'living_with', 'nation', 'phone', 'job', 'marriage_status', 'purpose', 'go_with', 'weather', 'time', 'age_group'], Numerical cols: ['id', 'age', 'income', 'fb_freq', 'yt_freq', 'tik_freq', 'use_less_than_2GB', 'use_2GB_to_4GB', 'number_child', 'viettel_no_0', 'viettel_no_1', 'viettel_no_2', 'to_hanoi', 'to_other', 'score', 'number_of_suggestions', 'number_of_plans', 'number_of_accept', 'number_of_accept_2', 'freq', 'accept_rate', 'Smaller_than_6M', '6M_to_12M', '12M_to_20M', 'Higher_than_20M', 'time_morning', 'time_afternoon', 'time_evening', 'time_night'], Scaler applied: False
2025-12-10 18:12:07,964 - INFO - [FS] Method: SelectKBest | k=40 | score_func=f_classif
2025-12-10 18:12:07,967 - INFO - [FS] Selector created. Will be fitted inside the pipeline.
2025-12-10 18:12:07,987 - INFO - Train shape: (4305, 43), Val shape: (1077, 43)
2025-12-10 18:12:08,014 - INFO - Downsample completed. Before: {3: 1158, 2: 1137, 4: 1018, 0: 542, 1: 450} | After: {0: 450, 1: 450, 2: 450, 3: 450, 4: 450}
2025-12-10 18:12:08,019 - INFO - Pipeline built successfully. Steps: ['preprocessor', 'selector', 'classifier']
2025-12-10 18:12:08,023 - INFO - Training started on 2250 samples using model=XGB.
2025-12-10 18:12:08,589 - INFO - Training completed in 0.56 seconds.
2025-12-10 18:12:08,593 - INFO - Hyperparameter search started. Method=GRID, Scoring=f1_macro
2025-12-10 18:14:32,155 - INFO - Hyperparameter optimization completed. Best params: {'classifier__colsample_bytree': 0.7, 'classifier__learning_rate': 0.01, 'classifier__max_depth': 6, 'classifier__n_estimators': 100, 'classifier__subsample': 0.9}
2025-12-10 18:14:32,160 - INFO - Retrain xgb after optimization...
2025-12-10 18:14:32,167 - INFO - Pipeline built successfully. Steps: ['preprocessor', 'selector', 'classifier']
2025-12-10 18:14:32,172 - INFO - Training started on 2250 samples using model=XGB.
2025-12-10 18:14:32,682 - INFO - Training completed in 0.51 seconds.
2025-12-10 18:14:32,688 - INFO - Preprocessing created. Will be fitted inside the pipeline. Categorical cols: ['name', 'gender', 'education', 'profession', 'living_with', 'nation', 'phone', 'job', 'marriage_status', 'purpose', 'go_with', 'weather', 'time', 'age_group'], Numerical cols: ['id', 'age', 'income', 'fb_freq', 'yt_freq', 'tik_freq', 'use_less_than_2GB', 'use_2GB_to_4GB', 'number_child', 'viettel_no_0', 'viettel_no_1', 'viettel_no_2', 'to_hanoi', 'to_other', 'score', 'number_of_suggestions', 'number_of_plans', 'number_of_accept', 'number_of_accept_2', 'freq', 'accept_rate', 'Smaller_than_6M', '6M_to_12M', '12M_to_20M', 'Higher_than_20M', 'time_morning', 'time_afternoon', 'time_evening', 'time_night'], Scaler applied: False
2025-12-10 18:14:32,692 - INFO - Evaluation started...
2025-12-10 18:14:32,753 - INFO - Evaluation results - Accuracy=0.5536, F1-macro=0.5294, Precision=0.5204, Recall=0.5512
2025-12-10 18:14:33,270 - INFO - ========== Running model: cat ==========
2025-12-10 18:14:33,311 - INFO - Data loaded with shape (5382, 44)
2025-12-10 18:14:33,329 - INFO - Preprocessing created. Will be fitted inside the pipeline. Categorical cols: ['name', 'gender', 'education', 'profession', 'living_with', 'nation', 'phone', 'job', 'marriage_status', 'purpose', 'go_with', 'weather', 'time', 'age_group'], Numerical cols: ['id', 'age', 'income', 'fb_freq', 'yt_freq', 'tik_freq', 'use_less_than_2GB', 'use_2GB_to_4GB', 'number_child', 'viettel_no_0', 'viettel_no_1', 'viettel_no_2', 'to_hanoi', 'to_other', 'score', 'number_of_suggestions', 'number_of_plans', 'number_of_accept', 'number_of_accept_2', 'freq', 'accept_rate', 'Smaller_than_6M', '6M_to_12M', '12M_to_20M', 'Higher_than_20M', 'time_morning', 'time_afternoon', 'time_evening', 'time_night'], Scaler applied: False
2025-12-10 18:14:33,332 - INFO - [FS] Method: SelectKBest | k=40 | score_func=f_classif
2025-12-10 18:14:33,335 - INFO - [FS] Selector created. Will be fitted inside the pipeline.
2025-12-10 18:14:33,362 - INFO - Train shape: (4305, 43), Val shape: (1077, 43)
2025-12-10 18:14:33,395 - INFO - Downsample completed. Before: {3: 1158, 2: 1137, 4: 1018, 0: 542, 1: 450} | After: {0: 450, 1: 450, 2: 450, 3: 450, 4: 450}
2025-12-10 18:14:33,402 - INFO - Pipeline built successfully. Steps: ['preprocessor', 'selector', 'classifier']
2025-12-10 18:14:33,403 - INFO - Training started on 2250 samples using model=CAT.
2025-12-10 18:14:41,377 - INFO - Training completed in 7.97 seconds.
2025-12-10 18:14:41,379 - INFO - Hyperparameter search started. Method=GRID, Scoring=f1_macro
2025-12-10 18:19:42,697 - INFO - Hyperparameter optimization completed. Best params: {'classifier__depth': 8, 'classifier__iterations': 100, 'classifier__l2_leaf_reg': 5, 'classifier__learning_rate': 0.01}
2025-12-10 18:19:42,701 - INFO - Retrain cat after optimization...
2025-12-10 18:19:42,704 - INFO - Pipeline built successfully. Steps: ['preprocessor', 'selector', 'classifier']
2025-12-10 18:19:42,705 - INFO - Training started on 2250 samples using model=CAT.
2025-12-10 18:19:50,677 - INFO - Training completed in 7.97 seconds.
2025-12-10 18:19:50,682 - INFO - Preprocessing created. Will be fitted inside the pipeline. Categorical cols: ['name', 'gender', 'education', 'profession', 'living_with', 'nation', 'phone', 'job', 'marriage_status', 'purpose', 'go_with', 'weather', 'time', 'age_group'], Numerical cols: ['id', 'age', 'income', 'fb_freq', 'yt_freq', 'tik_freq', 'use_less_than_2GB', 'use_2GB_to_4GB', 'number_child', 'viettel_no_0', 'viettel_no_1', 'viettel_no_2', 'to_hanoi', 'to_other', 'score', 'number_of_suggestions', 'number_of_plans', 'number_of_accept', 'number_of_accept_2', 'freq', 'accept_rate', 'Smaller_than_6M', '6M_to_12M', '12M_to_20M', 'Higher_than_20M', 'time_morning', 'time_afternoon', 'time_evening', 'time_night'], Scaler applied: False
2025-12-10 18:19:50,685 - INFO - Evaluation started...
2025-12-10 18:19:50,739 - INFO - Evaluation results - Accuracy=0.5411, F1-macro=0.5300, Precision=0.5199, Recall=0.5591
2025-12-10 18:20:18,921 - INFO - ========== Running model: lr ==========
2025-12-10 18:20:19,007 - INFO - Data loaded with shape (5382, 44)
2025-12-10 18:20:19,021 - INFO - Preprocessing created. Will be fitted inside the pipeline. Categorical cols: ['name', 'gender', 'education', 'profession', 'living_with', 'nation', 'phone', 'job', 'marriage_status', 'purpose', 'go_with', 'weather', 'time', 'age_group'], Numerical cols: ['id', 'age', 'income', 'fb_freq', 'yt_freq', 'tik_freq', 'use_less_than_2GB', 'use_2GB_to_4GB', 'number_child', 'viettel_no_0', 'viettel_no_1', 'viettel_no_2', 'to_hanoi', 'to_other', 'score', 'number_of_suggestions', 'number_of_plans', 'number_of_accept', 'number_of_accept_2', 'freq', 'accept_rate', 'Smaller_than_6M', '6M_to_12M', '12M_to_20M', 'Higher_than_20M', 'time_morning', 'time_afternoon', 'time_evening', 'time_night'], Scaler applied: True
2025-12-10 18:20:19,026 - INFO - [FS] Method: SelectKBest | k=40 | score_func=f_classif
2025-12-10 18:20:19,027 - INFO - [FS] Selector created. Will be fitted inside the pipeline.
2025-12-10 18:20:19,061 - INFO - Train shape: (4305, 43), Val shape: (1077, 43)
2025-12-10 18:20:19,106 - INFO - Downsample completed. Before: {3: 1158, 2: 1137, 4: 1018, 0: 542, 1: 450} | After: {0: 450, 1: 450, 2: 450, 3: 450, 4: 450}
2025-12-10 18:20:19,111 - INFO - Pipeline built successfully. Steps: ['preprocessor', 'selector', 'classifier']
2025-12-10 18:20:19,117 - INFO - Training started on 2250 samples using model=LR.
2025-12-10 18:20:19,617 - INFO - Training completed in 0.49 seconds.
2025-12-10 18:20:19,621 - INFO - Hyperparameter search started. Method=GRID, Scoring=f1_macro
2025-12-10 18:20:21,479 - INFO - Hyperparameter optimization completed. Best params: {'classifier__C': 0.1, 'classifier__max_iter': 500, 'classifier__solver': 'lbfgs'}
2025-12-10 18:20:21,489 - INFO - Retraining lr on full train+val with best params...
2025-12-10 18:20:22,024 - INFO - lr retrained on full train+val successfully.
2025-12-10 18:20:22,037 - INFO - Preprocessing created. Will be fitted inside the pipeline. Categorical cols: ['name', 'gender', 'education', 'profession', 'living_with', 'nation', 'phone', 'job', 'marriage_status', 'purpose', 'go_with', 'weather', 'time', 'age_group'], Numerical cols: ['id', 'age', 'income', 'fb_freq', 'yt_freq', 'tik_freq', 'use_less_than_2GB', 'use_2GB_to_4GB', 'number_child', 'viettel_no_0', 'viettel_no_1', 'viettel_no_2', 'to_hanoi', 'to_other', 'score', 'number_of_suggestions', 'number_of_plans', 'number_of_accept', 'number_of_accept_2', 'freq', 'accept_rate', 'Smaller_than_6M', '6M_to_12M', '12M_to_20M', 'Higher_than_20M', 'time_morning', 'time_afternoon', 'time_evening', 'time_night'], Scaler applied: True
2025-12-10 18:20:22,042 - INFO - Evaluation started...
2025-12-10 18:20:22,109 - INFO - Evaluation results - Accuracy=0.4289, F1-macro=0.3901, Precision=0.4145, Recall=0.3864
2025-12-10 18:20:23,077 - INFO - ========== Running model: svm ==========
2025-12-10 18:20:23,187 - INFO - Data loaded with shape (5382, 44)
2025-12-10 18:20:23,212 - INFO - Preprocessing created. Will be fitted inside the pipeline. Categorical cols: ['name', 'gender', 'education', 'profession', 'living_with', 'nation', 'phone', 'job', 'marriage_status', 'purpose', 'go_with', 'weather', 'time', 'age_group'], Numerical cols: ['id', 'age', 'income', 'fb_freq', 'yt_freq', 'tik_freq', 'use_less_than_2GB', 'use_2GB_to_4GB', 'number_child', 'viettel_no_0', 'viettel_no_1', 'viettel_no_2', 'to_hanoi', 'to_other', 'score', 'number_of_suggestions', 'number_of_plans', 'number_of_accept', 'number_of_accept_2', 'freq', 'accept_rate', 'Smaller_than_6M', '6M_to_12M', '12M_to_20M', 'Higher_than_20M', 'time_morning', 'time_afternoon', 'time_evening', 'time_night'], Scaler applied: True
2025-12-10 18:20:23,220 - INFO - [FS] Method: SelectKBest | k=40 | score_func=f_classif
2025-12-10 18:20:23,231 - INFO - [FS] Selector created. Will be fitted inside the pipeline.
2025-12-10 18:20:23,291 - INFO - Train shape: (4305, 43), Val shape: (1077, 43)
2025-12-10 18:20:23,320 - INFO - Downsample completed. Before: {3: 1158, 2: 1137, 4: 1018, 0: 542, 1: 450} | After: {0: 450, 1: 450, 2: 450, 3: 450, 4: 450}
2025-12-10 18:20:23,325 - INFO - Pipeline built successfully. Steps: ['preprocessor', 'selector', 'classifier']
2025-12-10 18:20:23,335 - INFO - Training started on 2250 samples using model=SVM.
2025-12-10 18:20:30,752 - INFO - Training completed in 7.41 seconds.
2025-12-10 18:20:30,754 - INFO - Hyperparameter search started. Method=GRID, Scoring=f1_macro
2025-12-10 18:21:00,394 - INFO - Hyperparameter optimization completed. Best params: {'classifier__C': 10.0, 'classifier__gamma': 'scale', 'classifier__kernel': 'rbf'}
2025-12-10 18:21:00,397 - INFO - Retraining svm on full train+val with best params...
2025-12-10 18:21:06,311 - INFO - svm retrained on full train+val successfully.
2025-12-10 18:21:06,320 - INFO - Preprocessing created. Will be fitted inside the pipeline. Categorical cols: ['name', 'gender', 'education', 'profession', 'living_with', 'nation', 'phone', 'job', 'marriage_status', 'purpose', 'go_with', 'weather', 'time', 'age_group'], Numerical cols: ['id', 'age', 'income', 'fb_freq', 'yt_freq', 'tik_freq', 'use_less_than_2GB', 'use_2GB_to_4GB', 'number_child', 'viettel_no_0', 'viettel_no_1', 'viettel_no_2', 'to_hanoi', 'to_other', 'score', 'number_of_suggestions', 'number_of_plans', 'number_of_accept', 'number_of_accept_2', 'freq', 'accept_rate', 'Smaller_than_6M', '6M_to_12M', '12M_to_20M', 'Higher_than_20M', 'time_morning', 'time_afternoon', 'time_evening', 'time_night'], Scaler applied: True
2025-12-10 18:21:06,326 - INFO - Evaluation started...
2025-12-10 18:21:06,544 - INFO - Evaluation results - Accuracy=0.5761, F1-macro=0.5382, Precision=0.5364, Recall=0.5437
2025-12-10 18:21:07,376 - INFO - ========== Running model: rf ==========
2025-12-10 18:21:07,412 - INFO - Data loaded with shape (5382, 44)
2025-12-10 18:21:07,420 - INFO - Preprocessing created. Will be fitted inside the pipeline. Categorical cols: ['name', 'gender', 'education', 'profession', 'living_with', 'nation', 'phone', 'job', 'marriage_status', 'purpose', 'go_with', 'weather', 'time', 'age_group'], Numerical cols: ['id', 'age', 'income', 'fb_freq', 'yt_freq', 'tik_freq', 'use_less_than_2GB', 'use_2GB_to_4GB', 'number_child', 'viettel_no_0', 'viettel_no_1', 'viettel_no_2', 'to_hanoi', 'to_other', 'score', 'number_of_suggestions', 'number_of_plans', 'number_of_accept', 'number_of_accept_2', 'freq', 'accept_rate', 'Smaller_than_6M', '6M_to_12M', '12M_to_20M', 'Higher_than_20M', 'time_morning', 'time_afternoon', 'time_evening', 'time_night'], Scaler applied: False
2025-12-10 18:21:07,422 - INFO - [FS] Method: SelectKBest | k=40 | score_func=f_classif
2025-12-10 18:21:07,423 - INFO - [FS] Selector created. Will be fitted inside the pipeline.
2025-12-10 18:21:07,438 - INFO - Train shape: (4305, 43), Val shape: (1077, 43)
2025-12-10 18:21:07,462 - INFO - Downsample completed. Before: {3: 1158, 2: 1137, 4: 1018, 0: 542, 1: 450} | After: {0: 450, 1: 450, 2: 450, 3: 450, 4: 450}
2025-12-10 18:21:07,465 - INFO - Pipeline built successfully. Steps: ['preprocessor', 'selector', 'classifier']
2025-12-10 18:21:07,467 - INFO - Training started on 2250 samples using model=RF.
2025-12-10 18:21:09,372 - INFO - Training completed in 1.90 seconds.
2025-12-10 18:21:09,374 - INFO - Hyperparameter search started. Method=GRID, Scoring=f1_macro
2025-12-10 18:23:35,869 - INFO - Hyperparameter optimization completed. Best params: {'classifier__max_depth': 20, 'classifier__min_samples_leaf': 1, 'classifier__min_samples_split': 10, 'classifier__n_estimators': 200}
2025-12-10 18:23:35,873 - INFO - Retraining rf on full train+val with best params...
2025-12-10 18:23:39,002 - INFO - rf retrained on full train+val successfully.
2025-12-10 18:23:39,007 - INFO - Preprocessing created. Will be fitted inside the pipeline. Categorical cols: ['name', 'gender', 'education', 'profession', 'living_with', 'nation', 'phone', 'job', 'marriage_status', 'purpose', 'go_with', 'weather', 'time', 'age_group'], Numerical cols: ['id', 'age', 'income', 'fb_freq', 'yt_freq', 'tik_freq', 'use_less_than_2GB', 'use_2GB_to_4GB', 'number_child', 'viettel_no_0', 'viettel_no_1', 'viettel_no_2', 'to_hanoi', 'to_other', 'score', 'number_of_suggestions', 'number_of_plans', 'number_of_accept', 'number_of_accept_2', 'freq', 'accept_rate', 'Smaller_than_6M', '6M_to_12M', '12M_to_20M', 'Higher_than_20M', 'time_morning', 'time_afternoon', 'time_evening', 'time_night'], Scaler applied: False
2025-12-10 18:23:39,010 - INFO - Evaluation started...
2025-12-10 18:23:39,092 - INFO - Evaluation results - Accuracy=0.6135, F1-macro=0.6017, Precision=0.6010, Recall=0.6079
2025-12-10 18:23:39,597 - INFO - ========== Running model: lgbm ==========
2025-12-10 18:23:39,639 - INFO - Data loaded with shape (5382, 44)
2025-12-10 18:23:39,649 - INFO - Preprocessing created. Will be fitted inside the pipeline. Categorical cols: ['name', 'gender', 'education', 'profession', 'living_with', 'nation', 'phone', 'job', 'marriage_status', 'purpose', 'go_with', 'weather', 'time', 'age_group'], Numerical cols: ['id', 'age', 'income', 'fb_freq', 'yt_freq', 'tik_freq', 'use_less_than_2GB', 'use_2GB_to_4GB', 'number_child', 'viettel_no_0', 'viettel_no_1', 'viettel_no_2', 'to_hanoi', 'to_other', 'score', 'number_of_suggestions', 'number_of_plans', 'number_of_accept', 'number_of_accept_2', 'freq', 'accept_rate', 'Smaller_than_6M', '6M_to_12M', '12M_to_20M', 'Higher_than_20M', 'time_morning', 'time_afternoon', 'time_evening', 'time_night'], Scaler applied: False
2025-12-10 18:23:39,651 - INFO - [FS] Method: SelectKBest | k=40 | score_func=f_classif
2025-12-10 18:23:39,654 - INFO - [FS] Selector created. Will be fitted inside the pipeline.
2025-12-10 18:23:39,672 - INFO - Train shape: (4305, 43), Val shape: (1077, 43)
2025-12-10 18:23:39,696 - INFO - Downsample completed. Before: {3: 1158, 2: 1137, 4: 1018, 0: 542, 1: 450} | After: {0: 450, 1: 450, 2: 450, 3: 450, 4: 450}
2025-12-10 18:23:39,701 - INFO - Pipeline built successfully. Steps: ['preprocessor', 'selector', 'classifier']
2025-12-10 18:23:39,704 - INFO - Training started on 2250 samples using model=LGBM.
2025-12-10 18:23:40,124 - INFO - Training completed in 0.42 seconds.
2025-12-10 18:23:40,127 - INFO - Hyperparameter search started. Method=GRID, Scoring=f1_macro
2025-12-10 18:25:20,656 - INFO - Hyperparameter optimization completed. Best params: {'classifier__learning_rate': 0.05, 'classifier__max_depth': -1, 'classifier__n_estimators': 300, 'classifier__num_leaves': 20}
2025-12-10 18:25:20,660 - INFO - Retraining lgbm on full train+val with best params...
2025-12-10 18:25:21,624 - INFO - lgbm retrained on full train+val successfully.
2025-12-10 18:25:21,630 - INFO - Preprocessing created. Will be fitted inside the pipeline. Categorical cols: ['name', 'gender', 'education', 'profession', 'living_with', 'nation', 'phone', 'job', 'marriage_status', 'purpose', 'go_with', 'weather', 'time', 'age_group'], Numerical cols: ['id', 'age', 'income', 'fb_freq', 'yt_freq', 'tik_freq', 'use_less_than_2GB', 'use_2GB_to_4GB', 'number_child', 'viettel_no_0', 'viettel_no_1', 'viettel_no_2', 'to_hanoi', 'to_other', 'score', 'number_of_suggestions', 'number_of_plans', 'number_of_accept', 'number_of_accept_2', 'freq', 'accept_rate', 'Smaller_than_6M', '6M_to_12M', '12M_to_20M', 'Higher_than_20M', 'time_morning', 'time_afternoon', 'time_evening', 'time_night'], Scaler applied: False
2025-12-10 18:25:21,632 - INFO - Evaluation started...
2025-12-10 18:25:21,744 - INFO - Evaluation results - Accuracy=0.5985, F1-macro=0.5790, Precision=0.5847, Recall=0.5788
2025-12-10 18:25:22,283 - INFO - ========== Running model: xgb ==========
2025-12-10 18:25:22,326 - INFO - Data loaded with shape (5382, 44)
2025-12-10 18:25:22,336 - INFO - Preprocessing created. Will be fitted inside the pipeline. Categorical cols: ['name', 'gender', 'education', 'profession', 'living_with', 'nation', 'phone', 'job', 'marriage_status', 'purpose', 'go_with', 'weather', 'time', 'age_group'], Numerical cols: ['id', 'age', 'income', 'fb_freq', 'yt_freq', 'tik_freq', 'use_less_than_2GB', 'use_2GB_to_4GB', 'number_child', 'viettel_no_0', 'viettel_no_1', 'viettel_no_2', 'to_hanoi', 'to_other', 'score', 'number_of_suggestions', 'number_of_plans', 'number_of_accept', 'number_of_accept_2', 'freq', 'accept_rate', 'Smaller_than_6M', '6M_to_12M', '12M_to_20M', 'Higher_than_20M', 'time_morning', 'time_afternoon', 'time_evening', 'time_night'], Scaler applied: False
2025-12-10 18:25:22,337 - INFO - [FS] Method: SelectKBest | k=40 | score_func=f_classif
2025-12-10 18:25:22,339 - INFO - [FS] Selector created. Will be fitted inside the pipeline.
2025-12-10 18:25:22,353 - INFO - Train shape: (4305, 43), Val shape: (1077, 43)
2025-12-10 18:25:22,376 - INFO - Downsample completed. Before: {3: 1158, 2: 1137, 4: 1018, 0: 542, 1: 450} | After: {0: 450, 1: 450, 2: 450, 3: 450, 4: 450}
2025-12-10 18:25:22,381 - INFO - Pipeline built successfully. Steps: ['preprocessor', 'selector', 'classifier']
2025-12-10 18:25:22,383 - INFO - Training started on 2250 samples using model=XGB.
2025-12-10 18:25:23,241 - INFO - Training completed in 0.86 seconds.
2025-12-10 18:25:23,245 - INFO - Hyperparameter search started. Method=GRID, Scoring=f1_macro
2025-12-10 18:28:06,578 - INFO - Hyperparameter optimization completed. Best params: {'classifier__colsample_bytree': 0.7, 'classifier__learning_rate': 0.01, 'classifier__max_depth': 6, 'classifier__n_estimators': 100, 'classifier__subsample': 0.9}
2025-12-10 18:28:06,583 - INFO - Retraining xgb on full train+val with best params...
2025-12-10 18:28:08,588 - INFO - xgb retrained on full train+val successfully.
2025-12-10 18:28:08,597 - INFO - Preprocessing created. Will be fitted inside the pipeline. Categorical cols: ['name', 'gender', 'education', 'profession', 'living_with', 'nation', 'phone', 'job', 'marriage_status', 'purpose', 'go_with', 'weather', 'time', 'age_group'], Numerical cols: ['id', 'age', 'income', 'fb_freq', 'yt_freq', 'tik_freq', 'use_less_than_2GB', 'use_2GB_to_4GB', 'number_child', 'viettel_no_0', 'viettel_no_1', 'viettel_no_2', 'to_hanoi', 'to_other', 'score', 'number_of_suggestions', 'number_of_plans', 'number_of_accept', 'number_of_accept_2', 'freq', 'accept_rate', 'Smaller_than_6M', '6M_to_12M', '12M_to_20M', 'Higher_than_20M', 'time_morning', 'time_afternoon', 'time_evening', 'time_night'], Scaler applied: False
2025-12-10 18:28:08,602 - INFO - Evaluation started...
2025-12-10 18:28:08,732 - INFO - Evaluation results - Accuracy=0.6060, F1-macro=0.5929, Precision=0.5935, Recall=0.6052
2025-12-10 18:28:09,447 - INFO - ========== Running model: cat ==========
2025-12-10 18:28:09,487 - INFO - Data loaded with shape (5382, 44)
2025-12-10 18:28:09,497 - INFO - Preprocessing created. Will be fitted inside the pipeline. Categorical cols: ['name', 'gender', 'education', 'profession', 'living_with', 'nation', 'phone', 'job', 'marriage_status', 'purpose', 'go_with', 'weather', 'time', 'age_group'], Numerical cols: ['id', 'age', 'income', 'fb_freq', 'yt_freq', 'tik_freq', 'use_less_than_2GB', 'use_2GB_to_4GB', 'number_child', 'viettel_no_0', 'viettel_no_1', 'viettel_no_2', 'to_hanoi', 'to_other', 'score', 'number_of_suggestions', 'number_of_plans', 'number_of_accept', 'number_of_accept_2', 'freq', 'accept_rate', 'Smaller_than_6M', '6M_to_12M', '12M_to_20M', 'Higher_than_20M', 'time_morning', 'time_afternoon', 'time_evening', 'time_night'], Scaler applied: False
2025-12-10 18:28:09,501 - INFO - [FS] Method: SelectKBest | k=40 | score_func=f_classif
2025-12-10 18:28:09,502 - INFO - [FS] Selector created. Will be fitted inside the pipeline.
2025-12-10 18:28:09,522 - INFO - Train shape: (4305, 43), Val shape: (1077, 43)
2025-12-10 18:28:09,548 - INFO - Downsample completed. Before: {3: 1158, 2: 1137, 4: 1018, 0: 542, 1: 450} | After: {0: 450, 1: 450, 2: 450, 3: 450, 4: 450}
2025-12-10 18:28:09,554 - INFO - Pipeline built successfully. Steps: ['preprocessor', 'selector', 'classifier']
2025-12-10 18:28:09,556 - INFO - Training started on 2250 samples using model=CAT.
2025-12-10 18:28:16,244 - INFO - Training completed in 6.69 seconds.
2025-12-10 18:28:16,246 - INFO - Hyperparameter search started. Method=GRID, Scoring=f1_macro
2025-12-10 18:33:17,077 - INFO - Hyperparameter optimization completed. Best params: {'classifier__depth': 8, 'classifier__iterations': 100, 'classifier__l2_leaf_reg': 5, 'classifier__learning_rate': 0.01}
2025-12-10 18:33:17,081 - INFO - Retraining cat on full train+val with best params...
2025-12-10 18:33:19,327 - INFO - cat retrained on full train+val successfully.
2025-12-10 18:33:19,333 - INFO - Preprocessing created. Will be fitted inside the pipeline. Categorical cols: ['name', 'gender', 'education', 'profession', 'living_with', 'nation', 'phone', 'job', 'marriage_status', 'purpose', 'go_with', 'weather', 'time', 'age_group'], Numerical cols: ['id', 'age', 'income', 'fb_freq', 'yt_freq', 'tik_freq', 'use_less_than_2GB', 'use_2GB_to_4GB', 'number_child', 'viettel_no_0', 'viettel_no_1', 'viettel_no_2', 'to_hanoi', 'to_other', 'score', 'number_of_suggestions', 'number_of_plans', 'number_of_accept', 'number_of_accept_2', 'freq', 'accept_rate', 'Smaller_than_6M', '6M_to_12M', '12M_to_20M', 'Higher_than_20M', 'time_morning', 'time_afternoon', 'time_evening', 'time_night'], Scaler applied: False
2025-12-10 18:33:19,337 - INFO - Evaluation started...
2025-12-10 18:33:19,403 - INFO - Evaluation results - Accuracy=0.5461, F1-macro=0.5538, Precision=0.5625, Recall=0.5827
2025-12-10 18:33:40,308 - INFO - ========== Running model: lr ==========
2025-12-10 18:33:40,338 - INFO - Data loaded with shape (5382, 44)
2025-12-10 18:33:40,346 - INFO - Preprocessing created. Will be fitted inside the pipeline. Categorical cols: ['name', 'gender', 'education', 'profession', 'living_with', 'nation', 'phone', 'job', 'marriage_status', 'purpose', 'go_with', 'weather', 'time', 'age_group'], Numerical cols: ['id', 'age', 'income', 'fb_freq', 'yt_freq', 'tik_freq', 'use_less_than_2GB', 'use_2GB_to_4GB', 'number_child', 'viettel_no_0', 'viettel_no_1', 'viettel_no_2', 'to_hanoi', 'to_other', 'score', 'number_of_suggestions', 'number_of_plans', 'number_of_accept', 'number_of_accept_2', 'freq', 'accept_rate', 'Smaller_than_6M', '6M_to_12M', '12M_to_20M', 'Higher_than_20M', 'time_morning', 'time_afternoon', 'time_evening', 'time_night'], Scaler applied: True
2025-12-10 18:33:40,348 - INFO - [FS] Method: SelectKBest | k=40 | score_func=f_classif
2025-12-10 18:33:40,350 - INFO - [FS] Selector created. Will be fitted inside the pipeline.
2025-12-10 18:33:40,364 - INFO - Train shape: (4305, 43), Val shape: (1077, 43)
2025-12-10 18:33:40,383 - INFO - Downsample completed. Before: {3: 1158, 2: 1137, 4: 1018, 0: 542, 1: 450} | After: {0: 450, 1: 450, 2: 450, 3: 450, 4: 450}
2025-12-10 18:33:40,385 - INFO - Pipeline built successfully. Steps: ['preprocessor', 'selector', 'classifier']
2025-12-10 18:33:40,387 - INFO - Training started on 2250 samples using model=LR.
2025-12-10 18:33:40,556 - INFO - Training completed in 0.17 seconds.
2025-12-10 18:33:40,559 - INFO - Hyperparameter search started. Method=RANDOM, Scoring=f1_macro
2025-12-10 18:33:41,545 - INFO - Hyperparameter optimization completed. Best params: {'classifier__solver': 'lbfgs', 'classifier__max_iter': 500, 'classifier__C': 0.1}
2025-12-10 18:33:41,552 - INFO - Retraining lr on full train+val with best params...
2025-12-10 18:33:41,777 - INFO - lr retrained on full train+val successfully.
2025-12-10 18:33:41,784 - INFO - Preprocessing created. Will be fitted inside the pipeline. Categorical cols: ['name', 'gender', 'education', 'profession', 'living_with', 'nation', 'phone', 'job', 'marriage_status', 'purpose', 'go_with', 'weather', 'time', 'age_group'], Numerical cols: ['id', 'age', 'income', 'fb_freq', 'yt_freq', 'tik_freq', 'use_less_than_2GB', 'use_2GB_to_4GB', 'number_child', 'viettel_no_0', 'viettel_no_1', 'viettel_no_2', 'to_hanoi', 'to_other', 'score', 'number_of_suggestions', 'number_of_plans', 'number_of_accept', 'number_of_accept_2', 'freq', 'accept_rate', 'Smaller_than_6M', '6M_to_12M', '12M_to_20M', 'Higher_than_20M', 'time_morning', 'time_afternoon', 'time_evening', 'time_night'], Scaler applied: True
2025-12-10 18:33:41,787 - INFO - Evaluation started...
2025-12-10 18:33:41,841 - INFO - Evaluation results - Accuracy=0.4289, F1-macro=0.3901, Precision=0.4145, Recall=0.3864
2025-12-10 18:33:42,527 - INFO - ========== Running model: svm ==========
2025-12-10 18:33:42,569 - INFO - Data loaded with shape (5382, 44)
2025-12-10 18:33:42,578 - INFO - Preprocessing created. Will be fitted inside the pipeline. Categorical cols: ['name', 'gender', 'education', 'profession', 'living_with', 'nation', 'phone', 'job', 'marriage_status', 'purpose', 'go_with', 'weather', 'time', 'age_group'], Numerical cols: ['id', 'age', 'income', 'fb_freq', 'yt_freq', 'tik_freq', 'use_less_than_2GB', 'use_2GB_to_4GB', 'number_child', 'viettel_no_0', 'viettel_no_1', 'viettel_no_2', 'to_hanoi', 'to_other', 'score', 'number_of_suggestions', 'number_of_plans', 'number_of_accept', 'number_of_accept_2', 'freq', 'accept_rate', 'Smaller_than_6M', '6M_to_12M', '12M_to_20M', 'Higher_than_20M', 'time_morning', 'time_afternoon', 'time_evening', 'time_night'], Scaler applied: True
2025-12-10 18:33:42,581 - INFO - [FS] Method: SelectKBest | k=40 | score_func=f_classif
2025-12-10 18:33:42,582 - INFO - [FS] Selector created. Will be fitted inside the pipeline.
2025-12-10 18:33:42,598 - INFO - Train shape: (4305, 43), Val shape: (1077, 43)
2025-12-10 18:33:42,621 - INFO - Downsample completed. Before: {3: 1158, 2: 1137, 4: 1018, 0: 542, 1: 450} | After: {0: 450, 1: 450, 2: 450, 3: 450, 4: 450}
2025-12-10 18:33:42,624 - INFO - Pipeline built successfully. Steps: ['preprocessor', 'selector', 'classifier']
2025-12-10 18:33:42,627 - INFO - Training started on 2250 samples using model=SVM.
2025-12-10 18:33:45,086 - INFO - Training completed in 2.46 seconds.
2025-12-10 18:33:45,088 - INFO - Hyperparameter search started. Method=RANDOM, Scoring=f1_macro
2025-12-10 18:34:14,866 - INFO - Hyperparameter optimization completed. Best params: {'classifier__kernel': 'rbf', 'classifier__gamma': 'scale', 'classifier__C': 10.0}
2025-12-10 18:34:14,869 - INFO - Retraining svm on full train+val with best params...
2025-12-10 18:34:21,822 - INFO - svm retrained on full train+val successfully.
2025-12-10 18:34:21,828 - INFO - Preprocessing created. Will be fitted inside the pipeline. Categorical cols: ['name', 'gender', 'education', 'profession', 'living_with', 'nation', 'phone', 'job', 'marriage_status', 'purpose', 'go_with', 'weather', 'time', 'age_group'], Numerical cols: ['id', 'age', 'income', 'fb_freq', 'yt_freq', 'tik_freq', 'use_less_than_2GB', 'use_2GB_to_4GB', 'number_child', 'viettel_no_0', 'viettel_no_1', 'viettel_no_2', 'to_hanoi', 'to_other', 'score', 'number_of_suggestions', 'number_of_plans', 'number_of_accept', 'number_of_accept_2', 'freq', 'accept_rate', 'Smaller_than_6M', '6M_to_12M', '12M_to_20M', 'Higher_than_20M', 'time_morning', 'time_afternoon', 'time_evening', 'time_night'], Scaler applied: True
2025-12-10 18:34:21,831 - INFO - Evaluation started...
2025-12-10 18:34:21,967 - INFO - Evaluation results - Accuracy=0.5761, F1-macro=0.5382, Precision=0.5364, Recall=0.5437
2025-12-10 18:34:22,531 - INFO - ========== Running model: rf ==========
2025-12-10 18:34:22,564 - INFO - Data loaded with shape (5382, 44)
2025-12-10 18:34:22,572 - INFO - Preprocessing created. Will be fitted inside the pipeline. Categorical cols: ['name', 'gender', 'education', 'profession', 'living_with', 'nation', 'phone', 'job', 'marriage_status', 'purpose', 'go_with', 'weather', 'time', 'age_group'], Numerical cols: ['id', 'age', 'income', 'fb_freq', 'yt_freq', 'tik_freq', 'use_less_than_2GB', 'use_2GB_to_4GB', 'number_child', 'viettel_no_0', 'viettel_no_1', 'viettel_no_2', 'to_hanoi', 'to_other', 'score', 'number_of_suggestions', 'number_of_plans', 'number_of_accept', 'number_of_accept_2', 'freq', 'accept_rate', 'Smaller_than_6M', '6M_to_12M', '12M_to_20M', 'Higher_than_20M', 'time_morning', 'time_afternoon', 'time_evening', 'time_night'], Scaler applied: False
2025-12-10 18:34:22,575 - INFO - [FS] Method: SelectKBest | k=40 | score_func=f_classif
2025-12-10 18:34:22,578 - INFO - [FS] Selector created. Will be fitted inside the pipeline.
2025-12-10 18:34:22,596 - INFO - Train shape: (4305, 43), Val shape: (1077, 43)
2025-12-10 18:34:22,621 - INFO - Downsample completed. Before: {3: 1158, 2: 1137, 4: 1018, 0: 542, 1: 450} | After: {0: 450, 1: 450, 2: 450, 3: 450, 4: 450}
2025-12-10 18:34:22,623 - INFO - Pipeline built successfully. Steps: ['preprocessor', 'selector', 'classifier']
2025-12-10 18:34:22,624 - INFO - Training started on 2250 samples using model=RF.
2025-12-10 18:34:23,973 - INFO - Training completed in 1.35 seconds.
2025-12-10 18:34:23,976 - INFO - Hyperparameter search started. Method=RANDOM, Scoring=f1_macro
2025-12-10 18:34:53,239 - INFO - Hyperparameter optimization completed. Best params: {'classifier__n_estimators': 200, 'classifier__min_samples_split': 10, 'classifier__min_samples_leaf': 1, 'classifier__max_depth': 20}
2025-12-10 18:34:53,243 - INFO - Retraining rf on full train+val with best params...
2025-12-10 18:34:55,747 - INFO - rf retrained on full train+val successfully.
2025-12-10 18:34:55,753 - INFO - Preprocessing created. Will be fitted inside the pipeline. Categorical cols: ['name', 'gender', 'education', 'profession', 'living_with', 'nation', 'phone', 'job', 'marriage_status', 'purpose', 'go_with', 'weather', 'time', 'age_group'], Numerical cols: ['id', 'age', 'income', 'fb_freq', 'yt_freq', 'tik_freq', 'use_less_than_2GB', 'use_2GB_to_4GB', 'number_child', 'viettel_no_0', 'viettel_no_1', 'viettel_no_2', 'to_hanoi', 'to_other', 'score', 'number_of_suggestions', 'number_of_plans', 'number_of_accept', 'number_of_accept_2', 'freq', 'accept_rate', 'Smaller_than_6M', '6M_to_12M', '12M_to_20M', 'Higher_than_20M', 'time_morning', 'time_afternoon', 'time_evening', 'time_night'], Scaler applied: False
2025-12-10 18:34:55,759 - INFO - Evaluation started...
2025-12-10 18:34:55,840 - INFO - Evaluation results - Accuracy=0.6135, F1-macro=0.6017, Precision=0.6010, Recall=0.6079
2025-12-10 18:34:56,548 - INFO - ========== Running model: lgbm ==========
2025-12-10 18:34:56,595 - INFO - Data loaded with shape (5382, 44)
2025-12-10 18:34:56,605 - INFO - Preprocessing created. Will be fitted inside the pipeline. Categorical cols: ['name', 'gender', 'education', 'profession', 'living_with', 'nation', 'phone', 'job', 'marriage_status', 'purpose', 'go_with', 'weather', 'time', 'age_group'], Numerical cols: ['id', 'age', 'income', 'fb_freq', 'yt_freq', 'tik_freq', 'use_less_than_2GB', 'use_2GB_to_4GB', 'number_child', 'viettel_no_0', 'viettel_no_1', 'viettel_no_2', 'to_hanoi', 'to_other', 'score', 'number_of_suggestions', 'number_of_plans', 'number_of_accept', 'number_of_accept_2', 'freq', 'accept_rate', 'Smaller_than_6M', '6M_to_12M', '12M_to_20M', 'Higher_than_20M', 'time_morning', 'time_afternoon', 'time_evening', 'time_night'], Scaler applied: False
2025-12-10 18:34:56,608 - INFO - [FS] Method: SelectKBest | k=40 | score_func=f_classif
2025-12-10 18:34:56,610 - INFO - [FS] Selector created. Will be fitted inside the pipeline.
2025-12-10 18:34:56,628 - INFO - Train shape: (4305, 43), Val shape: (1077, 43)
2025-12-10 18:34:56,652 - INFO - Downsample completed. Before: {3: 1158, 2: 1137, 4: 1018, 0: 542, 1: 450} | After: {0: 450, 1: 450, 2: 450, 3: 450, 4: 450}
2025-12-10 18:34:56,654 - INFO - Pipeline built successfully. Steps: ['preprocessor', 'selector', 'classifier']
2025-12-10 18:34:56,656 - INFO - Training started on 2250 samples using model=LGBM.
2025-12-10 18:34:57,294 - INFO - Training completed in 0.64 seconds.
2025-12-10 18:34:57,297 - INFO - Hyperparameter search started. Method=RANDOM, Scoring=f1_macro
2025-12-10 18:35:20,443 - INFO - Hyperparameter optimization completed. Best params: {'classifier__num_leaves': 20, 'classifier__n_estimators': 300, 'classifier__max_depth': -1, 'classifier__learning_rate': 0.05}
2025-12-10 18:35:20,446 - INFO - Retraining lgbm on full train+val with best params...
2025-12-10 18:35:21,396 - INFO - lgbm retrained on full train+val successfully.
2025-12-10 18:35:21,402 - INFO - Preprocessing created. Will be fitted inside the pipeline. Categorical cols: ['name', 'gender', 'education', 'profession', 'living_with', 'nation', 'phone', 'job', 'marriage_status', 'purpose', 'go_with', 'weather', 'time', 'age_group'], Numerical cols: ['id', 'age', 'income', 'fb_freq', 'yt_freq', 'tik_freq', 'use_less_than_2GB', 'use_2GB_to_4GB', 'number_child', 'viettel_no_0', 'viettel_no_1', 'viettel_no_2', 'to_hanoi', 'to_other', 'score', 'number_of_suggestions', 'number_of_plans', 'number_of_accept', 'number_of_accept_2', 'freq', 'accept_rate', 'Smaller_than_6M', '6M_to_12M', '12M_to_20M', 'Higher_than_20M', 'time_morning', 'time_afternoon', 'time_evening', 'time_night'], Scaler applied: False
2025-12-10 18:35:21,406 - INFO - Evaluation started...
2025-12-10 18:35:21,517 - INFO - Evaluation results - Accuracy=0.5985, F1-macro=0.5790, Precision=0.5847, Recall=0.5788
2025-12-10 18:35:22,052 - INFO - ========== Running model: xgb ==========
2025-12-10 18:35:22,092 - INFO - Data loaded with shape (5382, 44)
2025-12-10 18:35:22,101 - INFO - Preprocessing created. Will be fitted inside the pipeline. Categorical cols: ['name', 'gender', 'education', 'profession', 'living_with', 'nation', 'phone', 'job', 'marriage_status', 'purpose', 'go_with', 'weather', 'time', 'age_group'], Numerical cols: ['id', 'age', 'income', 'fb_freq', 'yt_freq', 'tik_freq', 'use_less_than_2GB', 'use_2GB_to_4GB', 'number_child', 'viettel_no_0', 'viettel_no_1', 'viettel_no_2', 'to_hanoi', 'to_other', 'score', 'number_of_suggestions', 'number_of_plans', 'number_of_accept', 'number_of_accept_2', 'freq', 'accept_rate', 'Smaller_than_6M', '6M_to_12M', '12M_to_20M', 'Higher_than_20M', 'time_morning', 'time_afternoon', 'time_evening', 'time_night'], Scaler applied: False
2025-12-10 18:35:22,102 - INFO - [FS] Method: SelectKBest | k=40 | score_func=f_classif
2025-12-10 18:35:22,104 - INFO - [FS] Selector created. Will be fitted inside the pipeline.
2025-12-10 18:35:22,118 - INFO - Train shape: (4305, 43), Val shape: (1077, 43)
2025-12-10 18:35:22,145 - INFO - Downsample completed. Before: {3: 1158, 2: 1137, 4: 1018, 0: 542, 1: 450} | After: {0: 450, 1: 450, 2: 450, 3: 450, 4: 450}
2025-12-10 18:35:22,150 - INFO - Pipeline built successfully. Steps: ['preprocessor', 'selector', 'classifier']
2025-12-10 18:35:22,152 - INFO - Training started on 2250 samples using model=XGB.
2025-12-10 18:35:22,652 - INFO - Training completed in 0.50 seconds.
2025-12-10 18:35:22,654 - INFO - Hyperparameter search started. Method=RANDOM, Scoring=f1_macro
2025-12-10 18:35:48,332 - INFO - Hyperparameter optimization completed. Best params: {'classifier__subsample': 0.9, 'classifier__n_estimators': 100, 'classifier__max_depth': 6, 'classifier__learning_rate': 0.05, 'classifier__colsample_bytree': 0.9}
2025-12-10 18:35:48,337 - INFO - Retraining xgb on full train+val with best params...
2025-12-10 18:35:48,912 - INFO - xgb retrained on full train+val successfully.
2025-12-10 18:35:48,920 - INFO - Preprocessing created. Will be fitted inside the pipeline. Categorical cols: ['name', 'gender', 'education', 'profession', 'living_with', 'nation', 'phone', 'job', 'marriage_status', 'purpose', 'go_with', 'weather', 'time', 'age_group'], Numerical cols: ['id', 'age', 'income', 'fb_freq', 'yt_freq', 'tik_freq', 'use_less_than_2GB', 'use_2GB_to_4GB', 'number_child', 'viettel_no_0', 'viettel_no_1', 'viettel_no_2', 'to_hanoi', 'to_other', 'score', 'number_of_suggestions', 'number_of_plans', 'number_of_accept', 'number_of_accept_2', 'freq', 'accept_rate', 'Smaller_than_6M', '6M_to_12M', '12M_to_20M', 'Higher_than_20M', 'time_morning', 'time_afternoon', 'time_evening', 'time_night'], Scaler applied: False
2025-12-10 18:35:48,924 - INFO - Evaluation started...
2025-12-10 18:35:49,004 - INFO - Evaluation results - Accuracy=0.6010, F1-macro=0.5821, Precision=0.5826, Recall=0.5880
2025-12-10 18:35:49,493 - INFO - ========== Running model: cat ==========
2025-12-10 18:35:49,532 - INFO - Data loaded with shape (5382, 44)
2025-12-10 18:35:49,545 - INFO - Preprocessing created. Will be fitted inside the pipeline. Categorical cols: ['name', 'gender', 'education', 'profession', 'living_with', 'nation', 'phone', 'job', 'marriage_status', 'purpose', 'go_with', 'weather', 'time', 'age_group'], Numerical cols: ['id', 'age', 'income', 'fb_freq', 'yt_freq', 'tik_freq', 'use_less_than_2GB', 'use_2GB_to_4GB', 'number_child', 'viettel_no_0', 'viettel_no_1', 'viettel_no_2', 'to_hanoi', 'to_other', 'score', 'number_of_suggestions', 'number_of_plans', 'number_of_accept', 'number_of_accept_2', 'freq', 'accept_rate', 'Smaller_than_6M', '6M_to_12M', '12M_to_20M', 'Higher_than_20M', 'time_morning', 'time_afternoon', 'time_evening', 'time_night'], Scaler applied: False
2025-12-10 18:35:49,549 - INFO - [FS] Method: SelectKBest | k=40 | score_func=f_classif
2025-12-10 18:35:49,552 - INFO - [FS] Selector created. Will be fitted inside the pipeline.
2025-12-10 18:35:49,574 - INFO - Train shape: (4305, 43), Val shape: (1077, 43)
2025-12-10 18:35:49,604 - INFO - Downsample completed. Before: {3: 1158, 2: 1137, 4: 1018, 0: 542, 1: 450} | After: {0: 450, 1: 450, 2: 450, 3: 450, 4: 450}
2025-12-10 18:35:49,610 - INFO - Pipeline built successfully. Steps: ['preprocessor', 'selector', 'classifier']
2025-12-10 18:35:49,611 - INFO - Training started on 2250 samples using model=CAT.
2025-12-10 18:35:57,720 - INFO - Training completed in 8.11 seconds.
2025-12-10 18:35:57,722 - INFO - Hyperparameter search started. Method=RANDOM, Scoring=f1_macro
2025-12-10 18:37:02,791 - INFO - Hyperparameter optimization completed. Best params: {'classifier__learning_rate': 0.05, 'classifier__l2_leaf_reg': 5, 'classifier__iterations': 100, 'classifier__depth': 8}
2025-12-10 18:37:02,793 - INFO - Retraining cat on full train+val with best params...
2025-12-10 18:37:05,108 - INFO - cat retrained on full train+val successfully.
2025-12-10 18:37:05,115 - INFO - Preprocessing created. Will be fitted inside the pipeline. Categorical cols: ['name', 'gender', 'education', 'profession', 'living_with', 'nation', 'phone', 'job', 'marriage_status', 'purpose', 'go_with', 'weather', 'time', 'age_group'], Numerical cols: ['id', 'age', 'income', 'fb_freq', 'yt_freq', 'tik_freq', 'use_less_than_2GB', 'use_2GB_to_4GB', 'number_child', 'viettel_no_0', 'viettel_no_1', 'viettel_no_2', 'to_hanoi', 'to_other', 'score', 'number_of_suggestions', 'number_of_plans', 'number_of_accept', 'number_of_accept_2', 'freq', 'accept_rate', 'Smaller_than_6M', '6M_to_12M', '12M_to_20M', 'Higher_than_20M', 'time_morning', 'time_afternoon', 'time_evening', 'time_night'], Scaler applied: False
2025-12-10 18:37:05,117 - INFO - Evaluation started...
2025-12-10 18:37:05,182 - INFO - Evaluation results - Accuracy=0.5786, F1-macro=0.5690, Precision=0.5815, Recall=0.5756
